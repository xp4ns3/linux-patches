

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Linux Base Driver for the Intel(R) Ethernet Controller 800 Series &mdash; The Linux Kernel 5.18.0-rc1-torvalds+ documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../../_static/theme_overrides.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../../_static/theme_rtd_colors.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../../search.html"/>
    <link rel="top" title="The Linux Kernel 5.18.0-rc1-torvalds+ documentation" href="../../../../index.html"/>
        <link rel="up" title="Ethernet Device Drivers" href="../index.html"/>
        <link rel="next" title="Marvell OcteonTx2 RVU Kernel Drivers" href="../marvell/octeontx2.html"/>
        <link rel="prev" title="Linux Base Driver for Intel(R) Ethernet Adaptive Virtual Function" href="iavf.html"/> 

  
  <script src="../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.18.0-rc2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../kbuild/index.html">Kernel Build System</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../devicetree/index.html">Open Firmware and Devicetree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../maintainer/index.html">Kernel Maintainer Handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../fault-injection/index.html">fault-injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../livepatch/index.html">Kernel Livepatching</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../locking/index.html">locking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../accounting/index.html">Accounting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../block/index.html">Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../cdrom/index.html">cdrom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../cpu-freq/index.html">Linux CPUFreq - CPU frequency and voltage scaling code in the Linux(TM) kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ide/index.html">Integrated Drive Electronics (IDE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../fb/index.html">Frame Buffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../fpga/index.html">fpga</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../hid/index.html">Human Interface Devices (HID)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../i2c/index.html">I2C/SMBus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../iio/index.html">Industrial I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../isdn/index.html">ISDN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../infiniband/index.html">InfiniBand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../leds/index.html">LEDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../netlabel/index.html">NetLabel</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">Linux Networking Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../af_xdp.html">AF_XDP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../bareudp.html">Bare UDP Tunnelling Module Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../batman-adv.html">batman-adv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../can.html">SocketCAN - Controller Area Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../can_ucan_protocol.html">The UCAN Protocol</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html">Hardware Device Drivers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../appletalk/index.html">AppleTalk Device Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../atm/index.html">Asynchronous Transfer Mode (ATM) Device Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cable/index.html">Cable Modem Device Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../can/index.html">Controller Area Network (CAN) Device Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cellular/index.html">Cellular Modem Device Drivers</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html">Ethernet Device Drivers</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../3com/3c509.html">Linux and the 3Com EtherLink III Series Ethercards (driver v1.18c and higher)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../3com/vortex.html">3Com Vortex device driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../amazon/ena.html">Linux kernel driver for Elastic Network Adapter (ENA) family</a></li>
<li class="toctree-l4"><a class="reference internal" href="../altera/altera_tse.html">Altera Triple-Speed Ethernet MAC driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../aquantia/atlantic.html">Marvell(Aquantia) AQtion Driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../chelsio/cxgb.html">Chelsio N210 10Gb Ethernet Network Controller</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cirrus/cs89x0.html">Cirrus Logic LAN CS8900/CS8920 Ethernet Adapters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dlink/dl2k.html">D-Link DL2000-based Gigabit Ethernet Adapter Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../davicom/dm9000.html">DM9000 Network driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dec/de4x5.html">DEC EtherWORKS Ethernet De4x5 cards</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dec/dmfe.html">Davicom DM9102(A)/DM9132/DM9801 fast ethernet driver for Linux</a></li>
<li class="toctree-l4"><a class="reference internal" href="../freescale/dpaa.html">The QorIQ DPAA Ethernet Driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../freescale/dpaa2/index.html">DPAA2 Documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../freescale/gianfar.html">The Gianfar Ethernet Driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../google/gve.html">Linux kernel driver for Compute Engine Virtual Ethernet (gve):</a></li>
<li class="toctree-l4"><a class="reference internal" href="../huawei/hinic.html">Linux Kernel Driver for Huawei Intelligent NIC(HiNIC) family</a></li>
<li class="toctree-l4"><a class="reference internal" href="e100.html">Linux Base Driver for the Intel(R) PRO/100 Family of Adapters</a></li>
<li class="toctree-l4"><a class="reference internal" href="e1000.html">Linux Base Driver for Intel(R) Ethernet Network Connection</a></li>
<li class="toctree-l4"><a class="reference internal" href="e1000e.html">Linux Driver for Intel(R) Ethernet Network Connection</a></li>
<li class="toctree-l4"><a class="reference internal" href="fm10k.html">Linux Base Driver for Intel(R) Ethernet Multi-host Controller</a></li>
<li class="toctree-l4"><a class="reference internal" href="igb.html">Linux Base Driver for Intel(R) Ethernet Network Connection</a></li>
<li class="toctree-l4"><a class="reference internal" href="igbvf.html">Linux Base Virtual Function Driver for Intel(R) 1G Ethernet</a></li>
<li class="toctree-l4"><a class="reference internal" href="ixgb.html">Linux Base Driver for 10 Gigabit Intel(R) Ethernet Network Connection</a></li>
<li class="toctree-l4"><a class="reference internal" href="ixgbe.html">Linux Base Driver for the Intel(R) Ethernet 10 Gigabit PCI Express Adapters</a></li>
<li class="toctree-l4"><a class="reference internal" href="ixgbevf.html">Linux Base Virtual Function Driver for Intel(R) 10G Ethernet</a></li>
<li class="toctree-l4"><a class="reference internal" href="i40e.html">Linux Base Driver for the Intel(R) Ethernet Controller 700 Series</a></li>
<li class="toctree-l4"><a class="reference internal" href="iavf.html">Linux Base Driver for Intel(R) Ethernet Adaptive Virtual Function</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Linux Base Driver for the Intel(R) Ethernet Controller 800 Series</a></li>
<li class="toctree-l4"><a class="reference internal" href="../marvell/octeontx2.html">Marvell OcteonTx2 RVU Kernel Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mellanox/mlx5.html">Mellanox ConnectX(R) mlx5 core VPI Network Driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../microsoft/netvsc.html">Hyper-V network driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../neterion/s2io.html">Neterion’s (Formerly S2io) Xframe I/II PCI-X 10GbE driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../neterion/vxge.html">Neterion’s (Formerly S2io) X3100 Series 10GbE PCIe Server Adapter Linux driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../netronome/nfp.html">Netronome Flow Processor (NFP) Kernel Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pensando/ionic.html">Linux Driver for the Pensando(R) Ethernet adapter family</a></li>
<li class="toctree-l4"><a class="reference internal" href="../smsc/smc9.html">SMC 9xxxx Driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stmicro/stmmac.html">Linux Driver for the Synopsys(R) Ethernet Controllers “stmmac”</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ti/cpsw.html">Texas Instruments CPSW ethernet driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ti/cpsw_switchdev.html">Texas Instruments CPSW switchdev based ethernet driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ti/am65_nuss_cpsw_switchdev.html">Texas Instruments K3 AM65 CPSW NUSS switchdev based ethernet driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ti/tlan.html">TLAN driver for Linux</a></li>
<li class="toctree-l4"><a class="reference internal" href="../toshiba/spider_net.html">The Spidernet Device Driver</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../fddi/index.html">Fiber Distributed Data Interface (FDDI) Device Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../hamradio/index.html">Amateur Radio Device Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../qlogic/index.html">QLogic QLGE Device Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../wan/index.html">Classic WAN Device Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../wifi/index.html">Wi-Fi Device Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../wwan/index.html">WWAN Device Drivers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../dsa/index.html">Distributed Switch Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../devlink/index.html">Linux Devlink Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../caif/index.html">CAIF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ethtool-netlink.html">Netlink interface for ethtool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ieee802154.html">IEEE 802.15.4 Developer’s Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../j1939.html">J1939 Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../kapi.html">Linux Networking and Network Devices APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../msg_zerocopy.html">MSG_ZEROCOPY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../failover.html">FAILOVER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../net_dim.html">Net DIM - Generic Network Dynamic Interrupt Moderation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../net_failover.html">NET_FAILOVER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../page_pool.html">Page Pool API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../phy.html">PHY Abstraction Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../sfp-phylink.html">phylink</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../alias.html">IP-Aliasing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../bridge.html">Ethernet Bridging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../snmp_counter.html">SNMP counter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../checksum-offloads.html">Checksum Offloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../segmentation-offloads.html">Segmentation Offloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../scaling.html">Scaling in the Linux Networking Stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tls.html">Kernel TLS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tls-offload.html">Kernel TLS offload</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nfc.html">Linux NFC subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../6lowpan.html">Netdev private dataroom for 6lowpan interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../6pack.html">6pack Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../arcnet-hardware.html">ARCnet Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../arcnet.html">ARCnet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../atm.html">ATM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ax25.html">AX.25</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../bonding.html">Linux Ethernet Bonding Driver HOWTO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../cdc_mbim.html">cdc_mbim - Driver for CDC MBIM Mobile Broadband modems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dccp.html">DCCP protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dctcp.html">DCTCP (DataCenter TCP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../decnet.html">Linux DECnet Networking Layer Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dns_resolver.html">DNS Resolver Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../driver.html">Softnet Driver Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../eql.html">EQL Driver: Serial IP Load Balancing HOWTO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../fib_trie.html">LC-trie implementation notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../filter.html">Linux Socket Filtering aka Berkeley Packet Filter (BPF)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generic-hdlc.html">Generic HDLC layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generic_netlink.html">Generic Netlink</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../gen_stats.html">Generic networking statistics for netlink users</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../gtp.html">The Linux kernel GTP tunneling module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ila.html">Identifier Locator Addressing (ILA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ioam6-sysctl.html">IOAM6 Sysfs variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ipddp.html">AppleTalk-IP Decapsulation and AppleTalk-IP Encapsulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ip_dynaddr.html">IP dynamic address hack-port v0.03</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ipsec.html">IPsec</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ip-sysctl.html">IP Sysctl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ipv6.html">IPv6</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ipvlan.html">IPVLAN Driver HOWTO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ipvs-sysctl.html">IPvs-sysctl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../kcm.html">Kernel Connection Multiplexor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../l2tp.html">L2TP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../lapb-module.html">The Linux LAPB Module Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../mac80211-injection.html">How to use packet injection with mac80211</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../mctp.html">Management Component Transport Protocol (MCTP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../mpls-sysctl.html">MPLS Sysfs variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../mptcp-sysctl.html">MPTCP Sysfs variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../multiqueue.html">HOWTO for multiqueue network device support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../netconsole.html">Netconsole</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../netdev-features.html">Netdev features mess and how to get out from it alive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../netdevices.html">Network Devices, the Kernel, and You!</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../netfilter-sysctl.html">Netfilter Sysfs variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../netif-msg.html">NETIF Msg Level</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nexthop-group-resilient.html">Resilient Next-hop Groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nf_conntrack-sysctl.html">Netfilter Conntrack Sysfs variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nf_flowtable.html">Netfilter’s flowtable infrastructure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../openvswitch.html">Open vSwitch datapath developer documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../operstates.html">Operational States</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../packet_mmap.html">Packet MMAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../phonet.html">Linux Phonet protocol family</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../pktgen.html">HOWTO for the linux packet generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../plip.html">PLIP: The Parallel Line Internet Protocol Device</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ppp_generic.html">PPP Generic Driver and Channel Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../proc_net_tcp.html">The proc/net/tcp and proc/net/tcp6 variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radiotap-headers.html">How to use radiotap headers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rds.html">RDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../regulatory.html">Linux wireless regulatory documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rxrpc.html">RxRPC Network Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rxrpc.html#socket-options">SOCKET OPTIONS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rxrpc.html#security">SECURITY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rxrpc.html#example-client-usage">EXAMPLE CLIENT USAGE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../sctp.html">Linux Kernel SCTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../secid.html">LSM/SeLinux secid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../seg6-sysctl.html">Seg6 Sysfs variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smc-sysctl.html">SMC Sysctl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../statistics.html">Interface statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../strparser.html">Stream Parser (strparser)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../switchdev.html">Ethernet switch device driver model (switchdev)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../sysfs-tagging.html">Sysfs tagging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tc-actions-env-rules.html">TC Actions - Environmental Rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tcp-thin.html">Thin-streams and TCP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../team.html">Team</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../timestamping.html">Timestamping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tipc.html">Linux Kernel TIPC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tproxy.html">Transparent proxy support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tuntap.html">Universal TUN/TAP device driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../udplite.html">The UDP-Lite protocol (RFC 3828)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vrf.html">Virtual Routing and Forwarding (VRF)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vxlan.html">Virtual eXtensible Local Area Networking documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../x25-iface.html">Packet Layer to Device Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../x25-iface.html#device-driver-to-packet-layer">Device Driver to Packet Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../x25-iface.html#requirements-for-the-device-driver">Requirements for the device driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../x25.html">Linux X.25 Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../xfrm_device.html">XFRM device - offloading the IPsec computations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../xfrm_proc.html">XFRM proc - /proc/net/xfrm_* files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../xfrm_sync.html">XFRM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../xfrm_sysctl.html">XFRM Syscall</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../pcmcia/index.html">pcmcia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../power/index.html">Power Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../target/index.html">TCM Virtual Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../timers/index.html">timers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../spi/index.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../w1/index.html">1-Wire Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../watchdog/index.html">Linux Watchdog Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../virt/index.html">Linux Virtualization Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../hwmon/index.html">Linux Hardware Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../filesystems/index.html">Filesystems in the Linux kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../vm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../usb/index.html">USB support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../PCI/index.html">Linux PCI Bus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../scsi/index.html">Linux SCSI Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../scheduler/index.html">Linux Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../mhi/index.html">MHI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tty/index.html">TTY</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../peci/index.html">Linux PECI Subsystem</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../asm-annotations.html">Assembler Annotations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../arch.html">CPU Architectures</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../tools/index.html">Kernel tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../staging/index.html">Unsorted Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../staging/index.html#atomic-types">Atomic Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../staging/index.html#atomic-bitops">Atomic bitops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../staging/index.html#memory-barriers">Memory Barriers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../watch_queue.html">General notification mechanism</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../translations/index.html">Translations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">The Linux Kernel</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../index.html">Linux Networking Documentation</a> &raquo;</li>
        
          <li><a href="../../index.html">Hardware Device Drivers</a> &raquo;</li>
        
          <li><a href="../index.html">Ethernet Device Drivers</a> &raquo;</li>
        
      <li>Linux Base Driver for the Intel(R) Ethernet Controller 800 Series</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../_sources/networking/device_drivers/ethernet/intel/ice.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="linux-base-driver-for-the-intel-r-ethernet-controller-800-series">
<h1>Linux Base Driver for the Intel(R) Ethernet Controller 800 Series<a class="headerlink" href="#linux-base-driver-for-the-intel-r-ethernet-controller-800-series" title="Permalink to this headline">¶</a></h1>
<p>Intel ice Linux driver.
Copyright(c) 2018-2021 Intel Corporation.</p>
<div class="section" id="contents">
<h2>Contents<a class="headerlink" href="#contents" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Overview</li>
<li>Identifying Your Adapter</li>
<li>Important Notes</li>
<li>Additional Features &amp; Configurations</li>
<li>Performance Optimization</li>
</ul>
<p>The associated Virtual Function (VF) driver for this driver is iavf.</p>
<p>Driver information can be obtained using ethtool and lspci.</p>
<p>For questions related to hardware requirements, refer to the documentation
supplied with your Intel adapter. All hardware requirements listed apply to use
with Linux.</p>
<p>This driver supports XDP (Express Data Path) and AF_XDP zero-copy. Note that
XDP is blocked for frame sizes larger than 3KB.</p>
</div>
<div class="section" id="identifying-your-adapter">
<h2>Identifying Your Adapter<a class="headerlink" href="#identifying-your-adapter" title="Permalink to this headline">¶</a></h2>
<p>For information on how to identify your adapter, and for the latest Intel
network drivers, refer to the Intel Support website:
<a class="reference external" href="https://www.intel.com/support">https://www.intel.com/support</a></p>
</div>
<div class="section" id="important-notes">
<h2>Important Notes<a class="headerlink" href="#important-notes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="packet-drops-may-occur-under-receive-stress">
<h3>Packet drops may occur under receive stress<a class="headerlink" href="#packet-drops-may-occur-under-receive-stress" title="Permalink to this headline">¶</a></h3>
<p>Devices based on the Intel(R) Ethernet Controller 800 Series are designed to
tolerate a limited amount of system latency during PCIe and DMA transactions.
If these transactions take longer than the tolerated latency, it can impact the
length of time the packets are buffered in the device and associated memory,
which may result in dropped packets. These packets drops typically do not have
a noticeable impact on throughput and performance under standard workloads.</p>
<p>If these packet drops appear to affect your workload, the following may improve
the situation:</p>
<ol class="arabic simple">
<li>Make sure that your system’s physical memory is in a high-performance
configuration, as recommended by the platform vendor. A common
recommendation is for all channels to be populated with a single DIMM
module.</li>
<li>In your system’s BIOS/UEFI settings, select the “Performance” profile.</li>
<li>Your distribution may provide tools like “tuned,” which can help tweak
kernel settings to achieve better standard settings for different workloads.</li>
</ol>
</div>
<div class="section" id="configuring-sr-iov-for-improved-network-security">
<h3>Configuring SR-IOV for improved network security<a class="headerlink" href="#configuring-sr-iov-for-improved-network-security" title="Permalink to this headline">¶</a></h3>
<p>In a virtualized environment, on Intel(R) Ethernet Network Adapters that
support SR-IOV, the virtual function (VF) may be subject to malicious behavior.
Software-generated layer two frames, like IEEE 802.3x (link flow control), IEEE
802.1Qbb (priority based flow-control), and others of this type, are not
expected and can throttle traffic between the host and the virtual switch,
reducing performance. To resolve this issue, and to ensure isolation from
unintended traffic streams, configure all SR-IOV enabled ports for VLAN tagging
from the administrative interface on the PF. This configuration allows
unexpected, and potentially malicious, frames to be dropped.</p>
<p>See “Configuring VLAN Tagging on SR-IOV Enabled Adapter Ports” later in this
README for configuration instructions.</p>
</div>
<div class="section" id="do-not-unload-port-driver-if-vf-with-active-vm-is-bound-to-it">
<h3>Do not unload port driver if VF with active VM is bound to it<a class="headerlink" href="#do-not-unload-port-driver-if-vf-with-active-vm-is-bound-to-it" title="Permalink to this headline">¶</a></h3>
<p>Do not unload a port’s driver if a Virtual Function (VF) with an active Virtual
Machine (VM) is bound to it. Doing so will cause the port to appear to hang.
Once the VM shuts down, or otherwise releases the VF, the command will
complete.</p>
</div>
<div class="section" id="important-notes-for-sr-iov-and-link-aggregation">
<h3>Important notes for SR-IOV and Link Aggregation<a class="headerlink" href="#important-notes-for-sr-iov-and-link-aggregation" title="Permalink to this headline">¶</a></h3>
<p>Link Aggregation is mutually exclusive with SR-IOV.</p>
<ul class="simple">
<li>If Link Aggregation is active, SR-IOV VFs cannot be created on the PF.</li>
<li>If SR-IOV is active, you cannot set up Link Aggregation on the interface.</li>
</ul>
<p>Bridging and MACVLAN are also affected by this. If you wish to use bridging or
MACVLAN with SR-IOV, you must set up bridging or MACVLAN before enabling
SR-IOV. If you are using bridging or MACVLAN in conjunction with SR-IOV, and
you want to remove the interface from the bridge or MACVLAN, you must follow
these steps:</p>
<ol class="arabic simple">
<li>Destroy SR-IOV VFs if they exist</li>
<li>Remove the interface from the bridge or MACVLAN</li>
<li>Recreate SRIOV VFs as needed</li>
</ol>
</div>
</div>
<div class="section" id="additional-features-and-configurations">
<h2>Additional Features and Configurations<a class="headerlink" href="#additional-features-and-configurations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="ethtool">
<h3>ethtool<a class="headerlink" href="#ethtool" title="Permalink to this headline">¶</a></h3>
<p>The driver utilizes the ethtool interface for driver configuration and
diagnostics, as well as displaying statistical information. The latest ethtool
version is required for this functionality. Download it at:
<a class="reference external" href="https://kernel.org/pub/software/network/ethtool/">https://kernel.org/pub/software/network/ethtool/</a></p>
<p>NOTE: The rx_bytes value of ethtool does not match the rx_bytes value of
Netdev, due to the 4-byte CRC being stripped by the device. The difference
between the two rx_bytes values will be 4 x the number of Rx packets. For
example, if Rx packets are 10 and Netdev (software statistics) displays
rx_bytes as “X”, then ethtool (hardware statistics) will display rx_bytes as
“X+40” (4 bytes CRC x 10 packets).</p>
</div>
<div class="section" id="viewing-link-messages">
<h3>Viewing Link Messages<a class="headerlink" href="#viewing-link-messages" title="Permalink to this headline">¶</a></h3>
<p>Link messages will not be displayed to the console if the distribution is
restricting system messages. In order to see network driver link messages on
your console, set dmesg to eight by entering the following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># dmesg -n 8
</pre></div>
</div>
<p>NOTE: This setting is not saved across reboots.</p>
</div>
<div class="section" id="dynamic-device-personalization">
<h3>Dynamic Device Personalization<a class="headerlink" href="#dynamic-device-personalization" title="Permalink to this headline">¶</a></h3>
<p>Dynamic Device Personalization (DDP) allows you to change the packet processing
pipeline of a device by applying a profile package to the device at runtime.
Profiles can be used to, for example, add support for new protocols, change
existing protocols, or change default settings. DDP profiles can also be rolled
back without rebooting the system.</p>
<p>The DDP package loads during device initialization. The driver looks for
<code class="docutils literal notranslate"><span class="pre">intel/ice/ddp/ice.pkg</span></code> in your firmware root (typically <code class="docutils literal notranslate"><span class="pre">/lib/firmware/</span></code>
or <code class="docutils literal notranslate"><span class="pre">/lib/firmware/updates/</span></code>) and checks that it contains a valid DDP package
file.</p>
<p>NOTE: Your distribution should likely have provided the latest DDP file, but if
ice.pkg is missing, you can find it in the linux-firmware repository or from
intel.com.</p>
<p>If the driver is unable to load the DDP package, the device will enter Safe
Mode. Safe Mode disables advanced and performance features and supports only
basic traffic and minimal functionality, such as updating the NVM or
downloading a new driver or DDP package. Safe Mode only applies to the affected
physical function and does not impact any other PFs. See the “Intel(R) Ethernet
Adapters and Devices User Guide” for more details on DDP and Safe Mode.</p>
<p>NOTES:</p>
<ul class="simple">
<li>If you encounter issues with the DDP package file, you may need to download
an updated driver or DDP package file. See the log messages for more
information.</li>
<li>The ice.pkg file is a symbolic link to the default DDP package file.</li>
<li>You cannot update the DDP package if any PF drivers are already loaded. To
overwrite a package, unload all PFs and then reload the driver with the new
package.</li>
<li>Only the first loaded PF per device can download a package for that device.</li>
</ul>
<p>You can install specific DDP package files for different physical devices in
the same system. To install a specific DDP package file:</p>
<ol class="arabic">
<li><p class="first">Download the DDP package file you want for your device.</p>
</li>
<li><p class="first">Rename the file ice-xxxxxxxxxxxxxxxx.pkg, where ‘xxxxxxxxxxxxxxxx’ is the
unique 64-bit PCI Express device serial number (in hex) of the device you
want the package downloaded on. The filename must include the complete
serial number (including leading zeros) and be all lowercase. For example,
if the 64-bit serial number is b887a3ffffca0568, then the file name would be
ice-b887a3ffffca0568.pkg.</p>
<p>To find the serial number from the PCI bus address, you can use the
following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># lspci -vv -s af:00.0 | grep -i Serial
Capabilities: [150 v1] Device Serial Number b8-87-a3-ff-ff-ca-05-68
</pre></div>
</div>
<p>You can use the following command to format the serial number without the
dashes:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># lspci -vv -s af:00.0 | grep -i Serial | awk &#39;{print $7}&#39; | sed s/-//g
b887a3ffffca0568
</pre></div>
</div>
</li>
<li><p class="first">Copy the renamed DDP package file to
<code class="docutils literal notranslate"><span class="pre">/lib/firmware/updates/intel/ice/ddp/</span></code>. If the directory does not yet
exist, create it before copying the file.</p>
</li>
<li><p class="first">Unload all of the PFs on the device.</p>
</li>
<li><p class="first">Reload the driver with the new package.</p>
</li>
</ol>
<p>NOTE: The presence of a device-specific DDP package file overrides the loading
of the default DDP package file (ice.pkg).</p>
</div>
<div class="section" id="intel-r-ethernet-flow-director">
<h3>Intel(R) Ethernet Flow Director<a class="headerlink" href="#intel-r-ethernet-flow-director" title="Permalink to this headline">¶</a></h3>
<p>The Intel Ethernet Flow Director performs the following tasks:</p>
<ul class="simple">
<li>Directs receive packets according to their flows to different queues</li>
<li>Enables tight control on routing a flow in the platform</li>
<li>Matches flows and CPU cores for flow affinity</li>
</ul>
<p>NOTE: This driver supports the following flow types:</p>
<ul class="simple">
<li>IPv4</li>
<li>TCPv4</li>
<li>UDPv4</li>
<li>SCTPv4</li>
<li>IPv6</li>
<li>TCPv6</li>
<li>UDPv6</li>
<li>SCTPv6</li>
</ul>
<p>Each flow type supports valid combinations of IP addresses (source or
destination) and UDP/TCP/SCTP ports (source and destination). You can supply
only a source IP address, a source IP address and a destination port, or any
combination of one or more of these four parameters.</p>
<p>NOTE: This driver allows you to filter traffic based on a user-defined flexible
two-byte pattern and offset by using the ethtool user-def and mask fields. Only
L3 and L4 flow types are supported for user-defined flexible filters. For a
given flow type, you must clear all Intel Ethernet Flow Director filters before
changing the input set (for that flow type).</p>
</div>
<div class="section" id="flow-director-filters">
<h3>Flow Director Filters<a class="headerlink" href="#flow-director-filters" title="Permalink to this headline">¶</a></h3>
<p>Flow Director filters are used to direct traffic that matches specified
characteristics. They are enabled through ethtool’s ntuple interface. To enable
or disable the Intel Ethernet Flow Director and these filters:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -K &lt;ethX&gt; ntuple &lt;off|on&gt;
</pre></div>
</div>
<p>NOTE: When you disable ntuple filters, all the user programmed filters are
flushed from the driver cache and hardware. All needed filters must be re-added
when ntuple is re-enabled.</p>
<p>To display all of the active filters:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -u &lt;ethX&gt;
</pre></div>
</div>
<p>To add a new filter:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -U &lt;ethX&gt; flow-type &lt;type&gt; src-ip &lt;ip&gt; [m &lt;ip_mask&gt;] dst-ip &lt;ip&gt;
[m &lt;ip_mask&gt;] src-port &lt;port&gt; [m &lt;port_mask&gt;] dst-port &lt;port&gt; [m &lt;port_mask&gt;]
action &lt;queue&gt;

Where:
  &lt;ethX&gt; - the Ethernet device to program
  &lt;type&gt; - can be ip4, tcp4, udp4, sctp4, ip6, tcp6, udp6, sctp6
  &lt;ip&gt; - the IP address to match on
  &lt;ip_mask&gt; - the IPv4 address to mask on
            NOTE: These filters use inverted masks.
  &lt;port&gt; - the port number to match on
  &lt;port_mask&gt; - the 16-bit integer for masking
            NOTE: These filters use inverted masks.
  &lt;queue&gt; - the queue to direct traffic toward (-1 discards the
            matched traffic)
</pre></div>
</div>
<p>To delete a filter:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -U &lt;ethX&gt; delete &lt;N&gt;

Where &lt;N&gt; is the filter ID displayed when printing all the active filters,
and may also have been specified using &quot;loc &lt;N&gt;&quot; when adding the filter.
</pre></div>
</div>
<p>EXAMPLES:</p>
<p>To add a filter that directs packet to queue 2:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -U &lt;ethX&gt; flow-type tcp4 src-ip 192.168.10.1 dst-ip \
192.168.10.2 src-port 2000 dst-port 2001 action 2 [loc 1]
</pre></div>
</div>
<p>To set a filter using only the source and destination IP address:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -U &lt;ethX&gt; flow-type tcp4 src-ip 192.168.10.1 dst-ip \
192.168.10.2 action 2 [loc 1]
</pre></div>
</div>
<p>To set a filter based on a user-defined pattern and offset:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -U &lt;ethX&gt; flow-type tcp4 src-ip 192.168.10.1 dst-ip \
192.168.10.2 user-def 0x4FFFF action 2 [loc 1]

where the value of the user-def field contains the offset (4 bytes) and
the pattern (0xffff).
</pre></div>
</div>
<p>To match TCP traffic sent from 192.168.0.1, port 5300, directed to 192.168.0.5,
port 80, and then send it to queue 7:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -U enp130s0 flow-type tcp4 src-ip 192.168.0.1 dst-ip 192.168.0.5
src-port 5300 dst-port 80 action 7
</pre></div>
</div>
<p>To add a TCPv4 filter with a partial mask for a source IP subnet:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -U &lt;ethX&gt; flow-type tcp4 src-ip 192.168.0.0 m 0.255.255.255 dst-ip
192.168.5.12 src-port 12600 dst-port 31 action 12
</pre></div>
</div>
<p>NOTES:</p>
<p>For each flow-type, the programmed filters must all have the same matching
input set. For example, issuing the following two commands is acceptable:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -U enp130s0 flow-type ip4 src-ip 192.168.0.1 src-port 5300 action 7
# ethtool -U enp130s0 flow-type ip4 src-ip 192.168.0.5 src-port 55 action 10
</pre></div>
</div>
<p>Issuing the next two commands, however, is not acceptable, since the first
specifies src-ip and the second specifies dst-ip:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -U enp130s0 flow-type ip4 src-ip 192.168.0.1 src-port 5300 action 7
# ethtool -U enp130s0 flow-type ip4 dst-ip 192.168.0.5 src-port 55 action 10
</pre></div>
</div>
<p>The second command will fail with an error. You may program multiple filters
with the same fields, using different values, but, on one device, you may not
program two tcp4 filters with different matching fields.</p>
<p>The ice driver does not support matching on a subportion of a field, thus
partial mask fields are not supported.</p>
</div>
<div class="section" id="flex-byte-flow-director-filters">
<h3>Flex Byte Flow Director Filters<a class="headerlink" href="#flex-byte-flow-director-filters" title="Permalink to this headline">¶</a></h3>
<p>The driver also supports matching user-defined data within the packet payload.
This flexible data is specified using the “user-def” field of the ethtool
command in the following way:</p>
<table border="1" class="docutils">
<colgroup>
<col width="52%" />
<col width="48%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">31</span>&#160;&#160;&#160; <span class="pre">28</span>&#160;&#160;&#160; <span class="pre">24</span>&#160;&#160;&#160; <span class="pre">20</span>&#160;&#160;&#160; <span class="pre">16</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">15</span>&#160;&#160;&#160; <span class="pre">12</span>&#160;&#160;&#160; <span class="pre">8</span>&#160;&#160;&#160; <span class="pre">4</span>&#160;&#160;&#160; <span class="pre">0</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">offset</span> <span class="pre">into</span> <span class="pre">packet</span> <span class="pre">payload</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">bytes</span> <span class="pre">of</span> <span class="pre">flexible</span> <span class="pre">data</span></code></td>
</tr>
</tbody>
</table>
<p>For example,</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>... user-def 0x4FFFF ...
</pre></div>
</div>
<p>tells the filter to look 4 bytes into the payload and match that value against
0xFFFF. The offset is based on the beginning of the payload, and not the
beginning of the packet. Thus</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>flow-type tcp4 ... user-def 0x8BEAF ...
</pre></div>
</div>
<p>would match TCP/IPv4 packets which have the value 0xBEAF 8 bytes into the
TCP/IPv4 payload.</p>
<p>Note that ICMP headers are parsed as 4 bytes of header and 4 bytes of payload.
Thus to match the first byte of the payload, you must actually add 4 bytes to
the offset. Also note that ip4 filters match both ICMP frames as well as raw
(unknown) ip4 frames, where the payload will be the L3 payload of the IP4
frame.</p>
<p>The maximum offset is 64. The hardware will only read up to 64 bytes of data
from the payload. The offset must be even because the flexible data is 2 bytes
long and must be aligned to byte 0 of the packet payload.</p>
<p>The user-defined flexible offset is also considered part of the input set and
cannot be programmed separately for multiple filters of the same type. However,
the flexible data is not part of the input set and multiple filters may use the
same offset but match against different data.</p>
</div>
<div class="section" id="rss-hash-flow">
<h3>RSS Hash Flow<a class="headerlink" href="#rss-hash-flow" title="Permalink to this headline">¶</a></h3>
<p>Allows you to set the hash bytes per flow type and any combination of one or
more options for Receive Side Scaling (RSS) hash byte configuration.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -N &lt;ethX&gt; rx-flow-hash &lt;type&gt; &lt;option&gt;

Where &lt;type&gt; is:
  tcp4  signifying TCP over IPv4
  udp4  signifying UDP over IPv4
  tcp6  signifying TCP over IPv6
  udp6  signifying UDP over IPv6
And &lt;option&gt; is one or more of:
  s     Hash on the IP source address of the Rx packet.
  d     Hash on the IP destination address of the Rx packet.
  f     Hash on bytes 0 and 1 of the Layer 4 header of the Rx packet.
  n     Hash on bytes 2 and 3 of the Layer 4 header of the Rx packet.
</pre></div>
</div>
</div>
<div class="section" id="accelerated-receive-flow-steering-arfs">
<h3>Accelerated Receive Flow Steering (aRFS)<a class="headerlink" href="#accelerated-receive-flow-steering-arfs" title="Permalink to this headline">¶</a></h3>
<p>Devices based on the Intel(R) Ethernet Controller 800 Series support
Accelerated Receive Flow Steering (aRFS) on the PF. aRFS is a load-balancing
mechanism that allows you to direct packets to the same CPU where an
application is running or consuming the packets in that flow.</p>
<p>NOTES:</p>
<ul>
<li><p class="first">aRFS requires that ntuple filtering is enabled via ethtool.</p>
</li>
<li><p class="first">aRFS support is limited to the following packet types:</p>
<blockquote>
<div><ul class="simple">
<li>TCP over IPv4 and IPv6</li>
<li>UDP over IPv4 and IPv6</li>
<li>Nonfragmented packets</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">aRFS only supports Flow Director filters, which consist of the
source/destination IP addresses and source/destination ports.</p>
</li>
<li><p class="first">aRFS and ethtool’s ntuple interface both use the device’s Flow Director. aRFS
and ntuple features can coexist, but you may encounter unexpected results if
there’s a conflict between aRFS and ntuple requests. See “Intel(R) Ethernet
Flow Director” for additional information.</p>
</li>
</ul>
<p>To set up aRFS:</p>
<ol class="arabic simple">
<li>Enable the Intel Ethernet Flow Director and ntuple filters using ethtool.</li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -K &lt;ethX&gt; ntuple on
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li>Set up the number of entries in the global flow table. For example:</li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># NUM_RPS_ENTRIES=16384
# echo $NUM_RPS_ENTRIES &gt; /proc/sys/net/core/rps_sock_flow_entries
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li>Set up the number of entries in the per-queue flow table. For example:</li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># NUM_RX_QUEUES=64
# for file in /sys/class/net/$IFACE/queues/rx-*/rps_flow_cnt; do
# echo $(($NUM_RPS_ENTRIES/$NUM_RX_QUEUES)) &gt; $file;
# done
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li>Disable the IRQ balance daemon (this is only a temporary stop of the service
until the next reboot).</li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># systemctl stop irqbalance
</pre></div>
</div>
<ol class="arabic" start="5">
<li><p class="first">Configure the interrupt affinity.</p>
<p>See <code class="docutils literal notranslate"><span class="pre">/Documentation/core-api/irq/irq-affinity.rst</span></code></p>
</li>
</ol>
<p>To disable aRFS using ethtool:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -K &lt;ethX&gt; ntuple off
</pre></div>
</div>
<p>NOTE: This command will disable ntuple filters and clear any aRFS filters in
software and hardware.</p>
<p>Example Use Case:</p>
<ol class="arabic simple">
<li>Set the server application on the desired CPU (e.g., CPU 4).</li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># taskset -c 4 netserver
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li>Use netperf to route traffic from the client to CPU 4 on the server with
aRFS configured. This example uses TCP over IPv4.</li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># netperf -H &lt;Host IPv4 Address&gt; -t TCP_STREAM
</pre></div>
</div>
</div>
<div class="section" id="enabling-virtual-functions-vfs">
<h3>Enabling Virtual Functions (VFs)<a class="headerlink" href="#enabling-virtual-functions-vfs" title="Permalink to this headline">¶</a></h3>
<p>Use sysfs to enable virtual functions (VF).</p>
<p>For example, you can create 4 VFs as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># echo 4 &gt; /sys/class/net/&lt;ethX&gt;/device/sriov_numvfs
</pre></div>
</div>
<p>To disable VFs, write 0 to the same file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># echo 0 &gt; /sys/class/net/&lt;ethX&gt;/device/sriov_numvfs
</pre></div>
</div>
<p>The maximum number of VFs for the ice driver is 256 total (all ports). To check
how many VFs each PF supports, use the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># cat /sys/class/net/&lt;ethX&gt;/device/sriov_totalvfs
</pre></div>
</div>
<p>Note: You cannot use SR-IOV when link aggregation (LAG)/bonding is active, and
vice versa. To enforce this, the driver checks for this mutual exclusion.</p>
</div>
<div class="section" id="displaying-vf-statistics-on-the-pf">
<h3>Displaying VF Statistics on the PF<a class="headerlink" href="#displaying-vf-statistics-on-the-pf" title="Permalink to this headline">¶</a></h3>
<p>Use the following command to display the statistics for the PF and its VFs:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ip -s link show dev &lt;ethX&gt;
</pre></div>
</div>
<p>NOTE: The output of this command can be very large due to the maximum number of
possible VFs.</p>
<p>The PF driver will display a subset of the statistics for the PF and for all
VFs that are configured. The PF will always print a statistics block for each
of the possible VFs, and it will show zero for all unconfigured VFs.</p>
</div>
<div class="section" id="configuring-vlan-tagging-on-sr-iov-enabled-adapter-ports">
<h3>Configuring VLAN Tagging on SR-IOV Enabled Adapter Ports<a class="headerlink" href="#configuring-vlan-tagging-on-sr-iov-enabled-adapter-ports" title="Permalink to this headline">¶</a></h3>
<p>To configure VLAN tagging for the ports on an SR-IOV enabled adapter, use the
following command. The VLAN configuration should be done before the VF driver
is loaded or the VM is booted. The VF is not aware of the VLAN tag being
inserted on transmit and removed on received frames (sometimes called “port
VLAN” mode).</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ip link set dev &lt;ethX&gt; vf &lt;id&gt; vlan &lt;vlan id&gt;
</pre></div>
</div>
<p>For example, the following will configure PF eth0 and the first VF on VLAN 10:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ip link set dev eth0 vf 0 vlan 10
</pre></div>
</div>
</div>
<div class="section" id="enabling-a-vf-link-if-the-port-is-disconnected">
<h3>Enabling a VF link if the port is disconnected<a class="headerlink" href="#enabling-a-vf-link-if-the-port-is-disconnected" title="Permalink to this headline">¶</a></h3>
<p>If the physical function (PF) link is down, you can force link up (from the
host PF) on any virtual functions (VF) bound to the PF.</p>
<p>For example, to force link up on VF 0 bound to PF eth0:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ip link set eth0 vf 0 state enable
</pre></div>
</div>
<p>Note: If the command does not work, it may not be supported by your system.</p>
</div>
<div class="section" id="setting-the-mac-address-for-a-vf">
<h3>Setting the MAC Address for a VF<a class="headerlink" href="#setting-the-mac-address-for-a-vf" title="Permalink to this headline">¶</a></h3>
<p>To change the MAC address for the specified VF:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ip link set &lt;ethX&gt; vf 0 mac &lt;address&gt;
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ip link set &lt;ethX&gt; vf 0 mac 00:01:02:03:04:05
</pre></div>
</div>
<p>This setting lasts until the PF is reloaded.</p>
<p>NOTE: Assigning a MAC address for a VF from the host will disable any
subsequent requests to change the MAC address from within the VM. This is a
security feature. The VM is not aware of this restriction, so if this is
attempted in the VM, it will trigger MDD events.</p>
</div>
<div class="section" id="trusted-vfs-and-vf-promiscuous-mode">
<h3>Trusted VFs and VF Promiscuous Mode<a class="headerlink" href="#trusted-vfs-and-vf-promiscuous-mode" title="Permalink to this headline">¶</a></h3>
<p>This feature allows you to designate a particular VF as trusted and allows that
trusted VF to request selective promiscuous mode on the Physical Function (PF).</p>
<p>To set a VF as trusted or untrusted, enter the following command in the
Hypervisor:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ip link set dev &lt;ethX&gt; vf 1 trust [on|off]
</pre></div>
</div>
<p>NOTE: It’s important to set the VF to trusted before setting promiscuous mode.
If the VM is not trusted, the PF will ignore promiscuous mode requests from the
VF. If the VM becomes trusted after the VF driver is loaded, you must make a
new request to set the VF to promiscuous.</p>
<p>Once the VF is designated as trusted, use the following commands in the VM to
set the VF to promiscuous mode.</p>
<p>For promiscuous all:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ip link set &lt;ethX&gt; promisc on
Where &lt;ethX&gt; is a VF interface in the VM
</pre></div>
</div>
<p>For promiscuous Multicast:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ip link set &lt;ethX&gt; allmulticast on
Where &lt;ethX&gt; is a VF interface in the VM
</pre></div>
</div>
<p>NOTE: By default, the ethtool private flag vf-true-promisc-support is set to
“off,” meaning that promiscuous mode for the VF will be limited. To set the
promiscuous mode for the VF to true promiscuous and allow the VF to see all
ingress traffic, use the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool --set-priv-flags &lt;ethX&gt; vf-true-promisc-support on
</pre></div>
</div>
<p>The vf-true-promisc-support private flag does not enable promiscuous mode;
rather, it designates which type of promiscuous mode (limited or true) you will
get when you enable promiscuous mode using the ip link commands above. Note
that this is a global setting that affects the entire device. However, the
vf-true-promisc-support private flag is only exposed to the first PF of the
device. The PF remains in limited promiscuous mode regardless of the
vf-true-promisc-support setting.</p>
<p>Next, add a VLAN interface on the VF interface. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ip link add link eth2 name eth2.100 type vlan id 100
</pre></div>
</div>
<p>Note that the order in which you set the VF to promiscuous mode and add the
VLAN interface does not matter (you can do either first). The result in this
example is that the VF will get all traffic that is tagged with VLAN 100.</p>
</div>
<div class="section" id="malicious-driver-detection-mdd-for-vfs">
<h3>Malicious Driver Detection (MDD) for VFs<a class="headerlink" href="#malicious-driver-detection-mdd-for-vfs" title="Permalink to this headline">¶</a></h3>
<p>Some Intel Ethernet devices use Malicious Driver Detection (MDD) to detect
malicious traffic from the VF and disable Tx/Rx queues or drop the offending
packet until a VF driver reset occurs. You can view MDD messages in the PF’s
system log using the dmesg command.</p>
<ul class="simple">
<li>If the PF driver logs MDD events from the VF, confirm that the correct VF
driver is installed.</li>
<li>To restore functionality, you can manually reload the VF or VM or enable
automatic VF resets.</li>
<li>When automatic VF resets are enabled, the PF driver will immediately reset
the VF and reenable queues when it detects MDD events on the receive path.</li>
<li>If automatic VF resets are disabled, the PF will not automatically reset the
VF when it detects MDD events.</li>
</ul>
<p>To enable or disable automatic VF resets, use the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool --set-priv-flags &lt;ethX&gt; mdd-auto-reset-vf on|off
</pre></div>
</div>
</div>
<div class="section" id="mac-and-vlan-anti-spoofing-feature-for-vfs">
<h3>MAC and VLAN Anti-Spoofing Feature for VFs<a class="headerlink" href="#mac-and-vlan-anti-spoofing-feature-for-vfs" title="Permalink to this headline">¶</a></h3>
<p>When a malicious driver on a Virtual Function (VF) interface attempts to send a
spoofed packet, it is dropped by the hardware and not transmitted.</p>
<p>NOTE: This feature can be disabled for a specific VF:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ip link set &lt;ethX&gt; vf &lt;vf id&gt; spoofchk {off|on}
</pre></div>
</div>
</div>
<div class="section" id="jumbo-frames">
<h3>Jumbo Frames<a class="headerlink" href="#jumbo-frames" title="Permalink to this headline">¶</a></h3>
<p>Jumbo Frames support is enabled by changing the Maximum Transmission Unit (MTU)
to a value larger than the default value of 1500.</p>
<p>Use the ifconfig command to increase the MTU size. For example, enter the
following where &lt;ethX&gt; is the interface number:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ifconfig &lt;ethX&gt; mtu 9000 up
</pre></div>
</div>
<p>Alternatively, you can use the ip command as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ip link set mtu 9000 dev &lt;ethX&gt;
# ip link set up dev &lt;ethX&gt;
</pre></div>
</div>
<p>This setting is not saved across reboots.</p>
<p>NOTE: The maximum MTU setting for jumbo frames is 9702. This corresponds to the
maximum jumbo frame size of 9728 bytes.</p>
<p>NOTE: This driver will attempt to use multiple page sized buffers to receive
each jumbo packet. This should help to avoid buffer starvation issues when
allocating receive packets.</p>
<p>NOTE: Packet loss may have a greater impact on throughput when you use jumbo
frames. If you observe a drop in performance after enabling jumbo frames,
enabling flow control may mitigate the issue.</p>
</div>
<div class="section" id="speed-and-duplex-configuration">
<h3>Speed and Duplex Configuration<a class="headerlink" href="#speed-and-duplex-configuration" title="Permalink to this headline">¶</a></h3>
<p>In addressing speed and duplex configuration issues, you need to distinguish
between copper-based adapters and fiber-based adapters.</p>
<p>In the default mode, an Intel(R) Ethernet Network Adapter using copper
connections will attempt to auto-negotiate with its link partner to determine
the best setting. If the adapter cannot establish link with the link partner
using auto-negotiation, you may need to manually configure the adapter and link
partner to identical settings to establish link and pass packets. This should
only be needed when attempting to link with an older switch that does not
support auto-negotiation or one that has been forced to a specific speed or
duplex mode. Your link partner must match the setting you choose. 1 Gbps speeds
and higher cannot be forced. Use the autonegotiation advertising setting to
manually set devices for 1 Gbps and higher.</p>
<p>Speed, duplex, and autonegotiation advertising are configured through the
ethtool utility. For the latest version, download and install ethtool from the
following website:</p>
<blockquote>
<div><a class="reference external" href="https://kernel.org/pub/software/network/ethtool/">https://kernel.org/pub/software/network/ethtool/</a></div></blockquote>
<p>To see the speed configurations your device supports, run the following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool &lt;ethX&gt;
</pre></div>
</div>
<p>Caution: Only experienced network administrators should force speed and duplex
or change autonegotiation advertising manually. The settings at the switch must
always match the adapter settings. Adapter performance may suffer or your
adapter may not operate if you configure the adapter differently from your
switch.</p>
</div>
<div class="section" id="data-center-bridging-dcb">
<h3>Data Center Bridging (DCB)<a class="headerlink" href="#data-center-bridging-dcb" title="Permalink to this headline">¶</a></h3>
<p>NOTE: The kernel assumes that TC0 is available, and will disable Priority Flow
Control (PFC) on the device if TC0 is not available. To fix this, ensure TC0 is
enabled when setting up DCB on your switch.</p>
<p>DCB is a configuration Quality of Service implementation in hardware. It uses
the VLAN priority tag (802.1p) to filter traffic. That means that there are 8
different priorities that traffic can be filtered into. It also enables
priority flow control (802.1Qbb) which can limit or eliminate the number of
dropped packets during network stress. Bandwidth can be allocated to each of
these priorities, which is enforced at the hardware level (802.1Qaz).</p>
<p>DCB is normally configured on the network using the DCBX protocol (802.1Qaz), a
specialization of LLDP (802.1AB). The ice driver supports the following
mutually exclusive variants of DCBX support:</p>
<ol class="arabic simple">
<li>Firmware-based LLDP Agent</li>
<li>Software-based LLDP Agent</li>
</ol>
<p>In firmware-based mode, firmware intercepts all LLDP traffic and handles DCBX
negotiation transparently for the user. In this mode, the adapter operates in
“willing” DCBX mode, receiving DCB settings from the link partner (typically a
switch). The local user can only query the negotiated DCB configuration. For
information on configuring DCBX parameters on a switch, please consult the
switch manufacturer’s documentation.</p>
<p>In software-based mode, LLDP traffic is forwarded to the network stack and user
space, where a software agent can handle it. In this mode, the adapter can
operate in either “willing” or “nonwilling” DCBX mode and DCB configuration can
be both queried and set locally. This mode requires the FW-based LLDP Agent to
be disabled.</p>
<p>NOTE:</p>
<ul class="simple">
<li>You can enable and disable the firmware-based LLDP Agent using an ethtool
private flag. Refer to the “FW-LLDP (Firmware Link Layer Discovery Protocol)”
section in this README for more information.</li>
<li>In software-based DCBX mode, you can configure DCB parameters using software
LLDP/DCBX agents that interface with the Linux kernel’s DCB Netlink API. We
recommend using OpenLLDP as the DCBX agent when running in software mode. For
more information, see the OpenLLDP man pages and
<a class="reference external" href="https://github.com/intel/openlldp">https://github.com/intel/openlldp</a>.</li>
<li>The driver implements the DCB netlink interface layer to allow the user space
to communicate with the driver and query DCB configuration for the port.</li>
<li>iSCSI with DCB is not supported.</li>
</ul>
</div>
<div class="section" id="fw-lldp-firmware-link-layer-discovery-protocol">
<h3>FW-LLDP (Firmware Link Layer Discovery Protocol)<a class="headerlink" href="#fw-lldp-firmware-link-layer-discovery-protocol" title="Permalink to this headline">¶</a></h3>
<p>Use ethtool to change FW-LLDP settings. The FW-LLDP setting is per port and
persists across boots.</p>
<p>To enable LLDP:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool --set-priv-flags &lt;ethX&gt; fw-lldp-agent on
</pre></div>
</div>
<p>To disable LLDP:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool --set-priv-flags &lt;ethX&gt; fw-lldp-agent off
</pre></div>
</div>
<p>To check the current LLDP setting:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool --show-priv-flags &lt;ethX&gt;
</pre></div>
</div>
<p>NOTE: You must enable the UEFI HII “LLDP Agent” attribute for this setting to
take effect. If “LLDP AGENT” is set to disabled, you cannot enable it from the
OS.</p>
</div>
<div class="section" id="flow-control">
<h3>Flow Control<a class="headerlink" href="#flow-control" title="Permalink to this headline">¶</a></h3>
<p>Ethernet Flow Control (IEEE 802.3x) can be configured with ethtool to enable
receiving and transmitting pause frames for ice. When transmit is enabled,
pause frames are generated when the receive packet buffer crosses a predefined
threshold. When receive is enabled, the transmit unit will halt for the time
delay specified when a pause frame is received.</p>
<p>NOTE: You must have a flow control capable link partner.</p>
<p>Flow Control is disabled by default.</p>
<p>Use ethtool to change the flow control settings.</p>
<p>To enable or disable Rx or Tx Flow Control:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -A &lt;ethX&gt; rx &lt;on|off&gt; tx &lt;on|off&gt;
</pre></div>
</div>
<p>Note: This command only enables or disables Flow Control if auto-negotiation is
disabled. If auto-negotiation is enabled, this command changes the parameters
used for auto-negotiation with the link partner.</p>
<p>Note: Flow Control auto-negotiation is part of link auto-negotiation. Depending
on your device, you may not be able to change the auto-negotiation setting.</p>
<p>NOTE:</p>
<ul>
<li><p class="first">The ice driver requires flow control on both the port and link partner. If
flow control is disabled on one of the sides, the port may appear to hang on
heavy traffic.</p>
</li>
<li><p class="first">You may encounter issues with link-level flow control (LFC) after disabling
DCB. The LFC status may show as enabled but traffic is not paused. To resolve
this issue, disable and reenable LFC using ethtool:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -A &lt;ethX&gt; rx off tx off
# ethtool -A &lt;ethX&gt; rx on tx on
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="napi">
<h3>NAPI<a class="headerlink" href="#napi" title="Permalink to this headline">¶</a></h3>
<p>This driver supports NAPI (Rx polling mode).
For more information on NAPI, see
<a class="reference external" href="https://www.linuxfoundation.org/collaborate/workgroups/networking/napi">https://www.linuxfoundation.org/collaborate/workgroups/networking/napi</a></p>
</div>
<div class="section" id="macvlan">
<h3>MACVLAN<a class="headerlink" href="#macvlan" title="Permalink to this headline">¶</a></h3>
<p>This driver supports MACVLAN. Kernel support for MACVLAN can be tested by
checking if the MACVLAN driver is loaded. You can run ‘lsmod | grep macvlan’ to
see if the MACVLAN driver is loaded or run ‘modprobe macvlan’ to try to load
the MACVLAN driver.</p>
<p>NOTE:</p>
<ul class="simple">
<li>In passthru mode, you can only set up one MACVLAN device. It will inherit the
MAC address of the underlying PF (Physical Function) device.</li>
</ul>
</div>
<div class="section" id="ieee-802-1ad-qinq-support">
<h3>IEEE 802.1ad (QinQ) Support<a class="headerlink" href="#ieee-802-1ad-qinq-support" title="Permalink to this headline">¶</a></h3>
<p>The IEEE 802.1ad standard, informally known as QinQ, allows for multiple VLAN
IDs within a single Ethernet frame. VLAN IDs are sometimes referred to as
“tags,” and multiple VLAN IDs are thus referred to as a “tag stack.” Tag stacks
allow L2 tunneling and the ability to segregate traffic within a particular
VLAN ID, among other uses.</p>
<p>NOTES:</p>
<ul>
<li><p class="first">Receive checksum offloads and VLAN acceleration are not supported for 802.1ad
(QinQ) packets.</p>
</li>
<li><p class="first">0x88A8 traffic will not be received unless VLAN stripping is disabled with
the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -K &lt;ethX&gt; rxvlan off
</pre></div>
</div>
</li>
<li><p class="first">0x88A8/0x8100 double VLANs cannot be used with 0x8100 or 0x8100/0x8100 VLANS
configured on the same port. 0x88a8/0x8100 traffic will not be received if
0x8100 VLANs are configured.</p>
</li>
<li><p class="first">The VF can only transmit 0x88A8/0x8100 (i.e., 802.1ad/802.1Q) traffic if:</p>
<blockquote>
<div><ol class="arabic simple">
<li>The VF is not assigned a port VLAN.</li>
<li>spoofchk is disabled from the PF. If you enable spoofchk, the VF will
not transmit 0x88A8/0x8100 traffic.</li>
</ol>
</div></blockquote>
</li>
<li><p class="first">The VF may not receive all network traffic based on the Inner VLAN header
when VF true promiscuous mode (vf-true-promisc-support) and double VLANs are
enabled in SR-IOV mode.</p>
</li>
</ul>
<p>The following are examples of how to configure 802.1ad (QinQ):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ip link add link eth0 eth0.24 type vlan proto 802.1ad id 24
# ip link add link eth0.24 eth0.24.371 type vlan proto 802.1Q id 371

Where &quot;24&quot; and &quot;371&quot; are example VLAN IDs.
</pre></div>
</div>
</div>
<div class="section" id="tunnel-overlay-stateless-offloads">
<h3>Tunnel/Overlay Stateless Offloads<a class="headerlink" href="#tunnel-overlay-stateless-offloads" title="Permalink to this headline">¶</a></h3>
<p>Supported tunnels and overlays include VXLAN, GENEVE, and others depending on
hardware and software configuration. Stateless offloads are enabled by default.</p>
<p>To view the current state of all offloads:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -k &lt;ethX&gt;
</pre></div>
</div>
</div>
<div class="section" id="udp-segmentation-offload">
<h3>UDP Segmentation Offload<a class="headerlink" href="#udp-segmentation-offload" title="Permalink to this headline">¶</a></h3>
<p>Allows the adapter to offload transmit segmentation of UDP packets with
payloads up to 64K into valid Ethernet frames. Because the adapter hardware is
able to complete data segmentation much faster than operating system software,
this feature may improve transmission performance.
In addition, the adapter may use fewer CPU resources.</p>
<p>NOTE:</p>
<ul class="simple">
<li>The application sending UDP packets must support UDP segmentation offload.</li>
</ul>
<p>To enable/disable UDP Segmentation Offload, issue the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -K &lt;ethX&gt; tx-udp-segmentation [off|on]
</pre></div>
</div>
</div>
</div>
<div class="section" id="performance-optimization">
<h2>Performance Optimization<a class="headerlink" href="#performance-optimization" title="Permalink to this headline">¶</a></h2>
<p>Driver defaults are meant to fit a wide variety of workloads, but if further
optimization is required, we recommend experimenting with the following
settings.</p>
<div class="section" id="rx-descriptor-ring-size">
<h3>Rx Descriptor Ring Size<a class="headerlink" href="#rx-descriptor-ring-size" title="Permalink to this headline">¶</a></h3>
<p>To reduce the number of Rx packet discards, increase the number of Rx
descriptors for each Rx ring using ethtool.</p>
<blockquote>
<div><p>Check if the interface is dropping Rx packets due to buffers being full
(rx_dropped.nic can mean that there is no PCIe bandwidth):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -S &lt;ethX&gt; | grep &quot;rx_dropped&quot;
</pre></div>
</div>
<p>If the previous command shows drops on queues, it may help to increase
the number of descriptors using ‘ethtool -G’:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -G &lt;ethX&gt; rx &lt;N&gt;
Where &lt;N&gt; is the desired number of ring entries/descriptors
</pre></div>
</div>
<p>This can provide temporary buffering for issues that create latency while
the CPUs process descriptors.</p>
</div></blockquote>
</div>
<div class="section" id="interrupt-rate-limiting">
<h3>Interrupt Rate Limiting<a class="headerlink" href="#interrupt-rate-limiting" title="Permalink to this headline">¶</a></h3>
<p>This driver supports an adaptive interrupt throttle rate (ITR) mechanism that
is tuned for general workloads. The user can customize the interrupt rate
control for specific workloads, via ethtool, adjusting the number of
microseconds between interrupts.</p>
<p>To set the interrupt rate manually, you must disable adaptive mode:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -C &lt;ethX&gt; adaptive-rx off adaptive-tx off
</pre></div>
</div>
<p>For lower CPU utilization:</p>
<blockquote>
<div><p>Disable adaptive ITR and lower Rx and Tx interrupts. The examples below
affect every queue of the specified interface.</p>
<p>Setting rx-usecs and tx-usecs to 80 will limit interrupts to about
12,500 interrupts per second per queue:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -C &lt;ethX&gt; adaptive-rx off adaptive-tx off rx-usecs 80 tx-usecs 80
</pre></div>
</div>
</div></blockquote>
<p>For reduced latency:</p>
<blockquote>
<div><p>Disable adaptive ITR and ITR by setting rx-usecs and tx-usecs to 0
using ethtool:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -C &lt;ethX&gt; adaptive-rx off adaptive-tx off rx-usecs 0 tx-usecs 0
</pre></div>
</div>
</div></blockquote>
<p>Per-queue interrupt rate settings:</p>
<blockquote>
<div><p>The following examples are for queues 1 and 3, but you can adjust other
queues.</p>
<p>To disable Rx adaptive ITR and set static Rx ITR to 10 microseconds or
about 100,000 interrupts/second, for queues 1 and 3:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool --per-queue &lt;ethX&gt; queue_mask 0xa --coalesce adaptive-rx off
rx-usecs 10
</pre></div>
</div>
<p>To show the current coalesce settings for queues 1 and 3:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool --per-queue &lt;ethX&gt; queue_mask 0xa --show-coalesce
</pre></div>
</div>
</div></blockquote>
<p>Bounding interrupt rates using rx-usecs-high:</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Valid Range:</th><td class="field-body"><p class="first">0-236 (0=no limit)</p>
<p class="last">The range of 0-236 microseconds provides an effective range of 4,237 to
250,000 interrupts per second. The value of rx-usecs-high can be set
independently of rx-usecs and tx-usecs in the same ethtool command, and is
also independent of the adaptive interrupt moderation algorithm. The
underlying hardware supports granularity in 4-microsecond intervals, so
adjacent values may result in the same interrupt rate.</p>
</td>
</tr>
</tbody>
</table>
<p>The following command would disable adaptive interrupt moderation, and allow
a maximum of 5 microseconds before indicating a receive or transmit was
complete. However, instead of resulting in as many as 200,000 interrupts per
second, it limits total interrupts per second to 50,000 via the rx-usecs-high
parameter.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -C &lt;ethX&gt; adaptive-rx off adaptive-tx off rx-usecs-high 20
rx-usecs 5 tx-usecs 5
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="virtualized-environments">
<h3>Virtualized Environments<a class="headerlink" href="#virtualized-environments" title="Permalink to this headline">¶</a></h3>
<p>In addition to the other suggestions in this section, the following may be
helpful to optimize performance in VMs.</p>
<blockquote>
<div><p>Using the appropriate mechanism (vcpupin) in the VM, pin the CPUs to
individual LCPUs, making sure to use a set of CPUs included in the
device’s local_cpulist: <code class="docutils literal notranslate"><span class="pre">/sys/class/net/&lt;ethX&gt;/device/local_cpulist</span></code>.</p>
<p>Configure as many Rx/Tx queues in the VM as available. (See the iavf driver
documentation for the number of queues supported.) For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -L &lt;virt_interface&gt; rx &lt;max&gt; tx &lt;max&gt;
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="support">
<h2>Support<a class="headerlink" href="#support" title="Permalink to this headline">¶</a></h2>
<p>For general information, go to the Intel support website at:
<a class="reference external" href="https://www.intel.com/support/">https://www.intel.com/support/</a></p>
<p>or the Intel Wired Networking project hosted by Sourceforge at:
<a class="reference external" href="https://sourceforge.net/projects/e1000">https://sourceforge.net/projects/e1000</a></p>
<p>If an issue is identified with the released source code on a supported kernel
with a supported adapter, email the specific information related to the issue
to <a class="reference external" href="mailto:e1000-devel&#37;&#52;&#48;lists&#46;sf&#46;net">e1000-devel<span>&#64;</span>lists<span>&#46;</span>sf<span>&#46;</span>net</a>.</p>
</div>
<div class="section" id="trademarks">
<h2>Trademarks<a class="headerlink" href="#trademarks" title="Permalink to this headline">¶</a></h2>
<p>Intel is a trademark or registered trademark of Intel Corporation or its
subsidiaries in the United States and/or other countries.</p>
<ul class="simple">
<li>Other names and brands may be claimed as the property of others.</li>
</ul>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../marvell/octeontx2.html" class="btn btn-neutral float-right" title="Marvell OcteonTx2 RVU Kernel Drivers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="iavf.html" class="btn btn-neutral" title="Linux Base Driver for Intel(R) Ethernet Adaptive Virtual Function" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../',
            VERSION:'5.18.0-rc1-torvalds+',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../../_static/language_data.js"></script>

  

  
  
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>