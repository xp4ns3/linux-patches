

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>HOWTO for the linux packet generator &mdash; The Linux Kernel 5.18.0-rc1-torvalds+ documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/theme_rtd_colors.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="The Linux Kernel 5.18.0-rc1-torvalds+ documentation" href="../index.html"/>
        <link rel="up" title="Linux Networking Documentation" href="index.html"/>
        <link rel="next" title="PLIP: The Parallel Line Internet Protocol Device" href="plip.html"/>
        <link rel="prev" title="Linux Phonet protocol family" href="phonet.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.18.0-rc2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kbuild/index.html">Kernel Build System</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devicetree/index.html">Open Firmware and Devicetree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintainer/index.html">Kernel Maintainer Handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fault-injection/index.html">fault-injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../livepatch/index.html">Kernel Livepatching</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../locking/index.html">locking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../accounting/index.html">Accounting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../block/index.html">Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cdrom/index.html">cdrom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpu-freq/index.html">Linux CPUFreq - CPU frequency and voltage scaling code in the Linux(TM) kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ide/index.html">Integrated Drive Electronics (IDE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fb/index.html">Frame Buffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpga/index.html">fpga</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hid/index.html">Human Interface Devices (HID)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../i2c/index.html">I2C/SMBus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../iio/index.html">Industrial I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../isdn/index.html">ISDN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infiniband/index.html">InfiniBand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../leds/index.html">LEDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../netlabel/index.html">NetLabel</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Linux Networking Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="af_xdp.html">AF_XDP</a></li>
<li class="toctree-l2"><a class="reference internal" href="bareudp.html">Bare UDP Tunnelling Module Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="batman-adv.html">batman-adv</a></li>
<li class="toctree-l2"><a class="reference internal" href="can.html">SocketCAN - Controller Area Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="can_ucan_protocol.html">The UCAN Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="device_drivers/index.html">Hardware Device Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="dsa/index.html">Distributed Switch Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="devlink/index.html">Linux Devlink Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="caif/index.html">CAIF</a></li>
<li class="toctree-l2"><a class="reference internal" href="ethtool-netlink.html">Netlink interface for ethtool</a></li>
<li class="toctree-l2"><a class="reference internal" href="ieee802154.html">IEEE 802.15.4 Developer’s Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="j1939.html">J1939 Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="kapi.html">Linux Networking and Network Devices APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="msg_zerocopy.html">MSG_ZEROCOPY</a></li>
<li class="toctree-l2"><a class="reference internal" href="failover.html">FAILOVER</a></li>
<li class="toctree-l2"><a class="reference internal" href="net_dim.html">Net DIM - Generic Network Dynamic Interrupt Moderation</a></li>
<li class="toctree-l2"><a class="reference internal" href="net_failover.html">NET_FAILOVER</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_pool.html">Page Pool API</a></li>
<li class="toctree-l2"><a class="reference internal" href="phy.html">PHY Abstraction Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="sfp-phylink.html">phylink</a></li>
<li class="toctree-l2"><a class="reference internal" href="alias.html">IP-Aliasing</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridge.html">Ethernet Bridging</a></li>
<li class="toctree-l2"><a class="reference internal" href="snmp_counter.html">SNMP counter</a></li>
<li class="toctree-l2"><a class="reference internal" href="checksum-offloads.html">Checksum Offloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="segmentation-offloads.html">Segmentation Offloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="scaling.html">Scaling in the Linux Networking Stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="tls.html">Kernel TLS</a></li>
<li class="toctree-l2"><a class="reference internal" href="tls-offload.html">Kernel TLS offload</a></li>
<li class="toctree-l2"><a class="reference internal" href="nfc.html">Linux NFC subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="6lowpan.html">Netdev private dataroom for 6lowpan interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="6pack.html">6pack Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="arcnet-hardware.html">ARCnet Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="arcnet.html">ARCnet</a></li>
<li class="toctree-l2"><a class="reference internal" href="atm.html">ATM</a></li>
<li class="toctree-l2"><a class="reference internal" href="ax25.html">AX.25</a></li>
<li class="toctree-l2"><a class="reference internal" href="bonding.html">Linux Ethernet Bonding Driver HOWTO</a></li>
<li class="toctree-l2"><a class="reference internal" href="cdc_mbim.html">cdc_mbim - Driver for CDC MBIM Mobile Broadband modems</a></li>
<li class="toctree-l2"><a class="reference internal" href="dccp.html">DCCP protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="dctcp.html">DCTCP (DataCenter TCP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="decnet.html">Linux DECnet Networking Layer Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="dns_resolver.html">DNS Resolver Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="driver.html">Softnet Driver Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="eql.html">EQL Driver: Serial IP Load Balancing HOWTO</a></li>
<li class="toctree-l2"><a class="reference internal" href="fib_trie.html">LC-trie implementation notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="filter.html">Linux Socket Filtering aka Berkeley Packet Filter (BPF)</a></li>
<li class="toctree-l2"><a class="reference internal" href="generic-hdlc.html">Generic HDLC layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="generic_netlink.html">Generic Netlink</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen_stats.html">Generic networking statistics for netlink users</a></li>
<li class="toctree-l2"><a class="reference internal" href="gtp.html">The Linux kernel GTP tunneling module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ila.html">Identifier Locator Addressing (ILA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="ioam6-sysctl.html">IOAM6 Sysfs variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipddp.html">AppleTalk-IP Decapsulation and AppleTalk-IP Encapsulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="ip_dynaddr.html">IP dynamic address hack-port v0.03</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipsec.html">IPsec</a></li>
<li class="toctree-l2"><a class="reference internal" href="ip-sysctl.html">IP Sysctl</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipv6.html">IPv6</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipvlan.html">IPVLAN Driver HOWTO</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipvs-sysctl.html">IPvs-sysctl</a></li>
<li class="toctree-l2"><a class="reference internal" href="kcm.html">Kernel Connection Multiplexor</a></li>
<li class="toctree-l2"><a class="reference internal" href="l2tp.html">L2TP</a></li>
<li class="toctree-l2"><a class="reference internal" href="lapb-module.html">The Linux LAPB Module Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="mac80211-injection.html">How to use packet injection with mac80211</a></li>
<li class="toctree-l2"><a class="reference internal" href="mctp.html">Management Component Transport Protocol (MCTP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpls-sysctl.html">MPLS Sysfs variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="mptcp-sysctl.html">MPTCP Sysfs variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="multiqueue.html">HOWTO for multiqueue network device support</a></li>
<li class="toctree-l2"><a class="reference internal" href="netconsole.html">Netconsole</a></li>
<li class="toctree-l2"><a class="reference internal" href="netdev-features.html">Netdev features mess and how to get out from it alive</a></li>
<li class="toctree-l2"><a class="reference internal" href="netdevices.html">Network Devices, the Kernel, and You!</a></li>
<li class="toctree-l2"><a class="reference internal" href="netfilter-sysctl.html">Netfilter Sysfs variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="netif-msg.html">NETIF Msg Level</a></li>
<li class="toctree-l2"><a class="reference internal" href="nexthop-group-resilient.html">Resilient Next-hop Groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="nf_conntrack-sysctl.html">Netfilter Conntrack Sysfs variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="nf_flowtable.html">Netfilter’s flowtable infrastructure</a></li>
<li class="toctree-l2"><a class="reference internal" href="openvswitch.html">Open vSwitch datapath developer documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="operstates.html">Operational States</a></li>
<li class="toctree-l2"><a class="reference internal" href="packet_mmap.html">Packet MMAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="phonet.html">Linux Phonet protocol family</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">HOWTO for the linux packet generator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tuning-nic-for-max-performance">Tuning NIC for max performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#kernel-threads">Kernel threads</a></li>
<li class="toctree-l3"><a class="reference internal" href="#viewing-devices">Viewing devices</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuring-devices">Configuring devices</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sample-scripts">Sample scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interrupt-affinity">Interrupt affinity</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enable-ipsec">Enable IPsec</a></li>
<li class="toctree-l3"><a class="reference internal" href="#current-commands-and-configuration-options">Current commands and configuration options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plip.html">PLIP: The Parallel Line Internet Protocol Device</a></li>
<li class="toctree-l2"><a class="reference internal" href="ppp_generic.html">PPP Generic Driver and Channel Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="proc_net_tcp.html">The proc/net/tcp and proc/net/tcp6 variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="radiotap-headers.html">How to use radiotap headers</a></li>
<li class="toctree-l2"><a class="reference internal" href="rds.html">RDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="regulatory.html">Linux wireless regulatory documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="rxrpc.html">RxRPC Network Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="rxrpc.html#socket-options">SOCKET OPTIONS</a></li>
<li class="toctree-l2"><a class="reference internal" href="rxrpc.html#security">SECURITY</a></li>
<li class="toctree-l2"><a class="reference internal" href="rxrpc.html#example-client-usage">EXAMPLE CLIENT USAGE</a></li>
<li class="toctree-l2"><a class="reference internal" href="sctp.html">Linux Kernel SCTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="secid.html">LSM/SeLinux secid</a></li>
<li class="toctree-l2"><a class="reference internal" href="seg6-sysctl.html">Seg6 Sysfs variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="smc-sysctl.html">SMC Sysctl</a></li>
<li class="toctree-l2"><a class="reference internal" href="statistics.html">Interface statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="strparser.html">Stream Parser (strparser)</a></li>
<li class="toctree-l2"><a class="reference internal" href="switchdev.html">Ethernet switch device driver model (switchdev)</a></li>
<li class="toctree-l2"><a class="reference internal" href="sysfs-tagging.html">Sysfs tagging</a></li>
<li class="toctree-l2"><a class="reference internal" href="tc-actions-env-rules.html">TC Actions - Environmental Rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="tcp-thin.html">Thin-streams and TCP</a></li>
<li class="toctree-l2"><a class="reference internal" href="team.html">Team</a></li>
<li class="toctree-l2"><a class="reference internal" href="timestamping.html">Timestamping</a></li>
<li class="toctree-l2"><a class="reference internal" href="tipc.html">Linux Kernel TIPC</a></li>
<li class="toctree-l2"><a class="reference internal" href="tproxy.html">Transparent proxy support</a></li>
<li class="toctree-l2"><a class="reference internal" href="tuntap.html">Universal TUN/TAP device driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="udplite.html">The UDP-Lite protocol (RFC 3828)</a></li>
<li class="toctree-l2"><a class="reference internal" href="vrf.html">Virtual Routing and Forwarding (VRF)</a></li>
<li class="toctree-l2"><a class="reference internal" href="vxlan.html">Virtual eXtensible Local Area Networking documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="x25-iface.html">Packet Layer to Device Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="x25-iface.html#device-driver-to-packet-layer">Device Driver to Packet Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="x25-iface.html#requirements-for-the-device-driver">Requirements for the device driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="x25.html">Linux X.25 Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="xfrm_device.html">XFRM device - offloading the IPsec computations</a></li>
<li class="toctree-l2"><a class="reference internal" href="xfrm_proc.html">XFRM proc - /proc/net/xfrm_* files</a></li>
<li class="toctree-l2"><a class="reference internal" href="xfrm_sync.html">XFRM</a></li>
<li class="toctree-l2"><a class="reference internal" href="xfrm_sysctl.html">XFRM Syscall</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pcmcia/index.html">pcmcia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../power/index.html">Power Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../target/index.html">TCM Virtual Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../timers/index.html">timers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spi/index.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../w1/index.html">1-Wire Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../watchdog/index.html">Linux Watchdog Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../virt/index.html">Linux Virtualization Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hwmon/index.html">Linux Hardware Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filesystems/index.html">Filesystems in the Linux kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usb/index.html">USB support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PCI/index.html">Linux PCI Bus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scsi/index.html">Linux SCSI Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scheduler/index.html">Linux Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mhi/index.html">MHI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tty/index.html">TTY</a></li>
<li class="toctree-l1"><a class="reference internal" href="../peci/index.html">Linux PECI Subsystem</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../asm-annotations.html">Assembler Annotations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../arch.html">CPU Architectures</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Kernel tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html">Unsorted Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html#atomic-types">Atomic Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html#atomic-bitops">Atomic bitops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html#memory-barriers">Memory Barriers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../watch_queue.html">General notification mechanism</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/index.html">Translations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Linux Kernel</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Linux Networking Documentation</a> &raquo;</li>
        
      <li>HOWTO for the linux packet generator</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/networking/pktgen.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="howto-for-the-linux-packet-generator">
<h1>HOWTO for the linux packet generator<a class="headerlink" href="#howto-for-the-linux-packet-generator" title="Permalink to this headline">¶</a></h1>
<p>Enable CONFIG_NET_PKTGEN to compile and build pktgen either in-kernel
or as a module.  A module is preferred; modprobe pktgen if needed.  Once
running, pktgen creates a thread for each CPU with affinity to that CPU.
Monitoring and controlling is done via /proc.  It is easiest to select a
suitable sample script and configure that.</p>
<p>On a dual CPU:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ps aux | grep pkt
root       129  0.3  0.0     0    0 ?        SW    2003 523:20 [kpktgend_0]
root       130  0.3  0.0     0    0 ?        SW    2003 509:50 [kpktgend_1]
</pre></div>
</div>
<p>For monitoring and control pktgen creates:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/proc/net/pktgen/pgctrl
/proc/net/pktgen/kpktgend_X
/proc/net/pktgen/ethX
</pre></div>
</div>
<div class="section" id="tuning-nic-for-max-performance">
<h2>Tuning NIC for max performance<a class="headerlink" href="#tuning-nic-for-max-performance" title="Permalink to this headline">¶</a></h2>
<p>The default NIC settings are (likely) not tuned for pktgen’s artificial
overload type of benchmarking, as this could hurt the normal use-case.</p>
<p>Specifically increasing the TX ring buffer in the NIC:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -G ethX tx 1024
</pre></div>
</div>
<p>A larger TX ring can improve pktgen’s performance, while it can hurt
in the general case, 1) because the TX ring buffer might get larger
than the CPU’s L1/L2 cache, 2) because it allows more queueing in the
NIC HW layer (which is bad for bufferbloat).</p>
<p>One should hesitate to conclude that packets/descriptors in the HW
TX ring cause delay.  Drivers usually delay cleaning up the
ring-buffers for various performance reasons, and packets stalling
the TX ring might just be waiting for cleanup.</p>
<p>This cleanup issue is specifically the case for the driver ixgbe
(Intel 82599 chip).  This driver (ixgbe) combines TX+RX ring cleanups,
and the cleanup interval is affected by the ethtool –coalesce setting
of parameter “rx-usecs”.</p>
<p>For ixgbe use e.g. “30” resulting in approx 33K interrupts/sec (1/30*10^6):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ethtool -C ethX rx-usecs 30
</pre></div>
</div>
</div>
<div class="section" id="kernel-threads">
<h2>Kernel threads<a class="headerlink" href="#kernel-threads" title="Permalink to this headline">¶</a></h2>
<p>Pktgen creates a thread for each CPU with affinity to that CPU.
Which is controlled through procfile /proc/net/pktgen/kpktgend_X.</p>
<p>Example: /proc/net/pktgen/kpktgend_0:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Running:
Stopped: eth4@0
Result: OK: add_device=eth4@0
</pre></div>
</div>
<p>Most important are the devices assigned to the thread.</p>
<p>The two basic thread commands are:</p>
<blockquote>
<div><ul class="simple">
<li>add_device <a class="reference external" href="mailto:DEVICE&#37;&#52;&#48;NAME">DEVICE<span>&#64;</span>NAME</a> – adds a single device</li>
<li>rem_device_all         – remove all associated devices</li>
</ul>
</div></blockquote>
<p>When adding a device to a thread, a corresponding procfile is created
which is used for configuring this device. Thus, device names need to
be unique.</p>
<p>To support adding the same device to multiple threads, which is useful
with multi queue NICs, the device naming scheme is extended with “&#64;”:
<a class="reference external" href="mailto:device&#37;&#52;&#48;something">device<span>&#64;</span>something</a></p>
<p>The part after “&#64;” can be anything, but it is custom to use the thread
number.</p>
</div>
<div class="section" id="viewing-devices">
<h2>Viewing devices<a class="headerlink" href="#viewing-devices" title="Permalink to this headline">¶</a></h2>
<p>The Params section holds configured information.  The Current section
holds running statistics.  The Result is printed after a run or after
interruption.  Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/proc/net/pktgen/eth4@0

Params: count 100000  min_pkt_size: 60  max_pkt_size: 60
    frags: 0  delay: 0  clone_skb: 64  ifname: eth4@0
    flows: 0 flowlen: 0
    queue_map_min: 0  queue_map_max: 0
    dst_min: 192.168.81.2  dst_max:
    src_min:   src_max:
    src_mac: 90:e2:ba:0a:56:b4 dst_mac: 00:1b:21:3c:9d:f8
    udp_src_min: 9  udp_src_max: 109  udp_dst_min: 9  udp_dst_max: 9
    src_mac_count: 0  dst_mac_count: 0
    Flags: UDPSRC_RND  NO_TIMESTAMP  QUEUE_MAP_CPU
Current:
    pkts-sofar: 100000  errors: 0
    started: 623913381008us  stopped: 623913396439us idle: 25us
    seq_num: 100001  cur_dst_mac_offset: 0  cur_src_mac_offset: 0
    cur_saddr: 192.168.8.3  cur_daddr: 192.168.81.2
    cur_udp_dst: 9  cur_udp_src: 42
    cur_queue_map: 0
    flows: 0
Result: OK: 15430(c15405+d25) usec, 100000 (60byte,0frags)
6480562pps 3110Mb/sec (3110669760bps) errors: 0
</pre></div>
</div>
</div>
<div class="section" id="configuring-devices">
<h2>Configuring devices<a class="headerlink" href="#configuring-devices" title="Permalink to this headline">¶</a></h2>
<p>This is done via the /proc interface, and most easily done via pgset
as defined in the sample scripts.
You need to specify PGDEV environment variable to use functions from sample
scripts, i.e.:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>export PGDEV=/proc/net/pktgen/eth4@0
source samples/pktgen/functions.sh
</pre></div>
</div>
<p>Examples:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pg_ctrl start           starts injection.
pg_ctrl stop            aborts injection. Also, ^C aborts generator.

pgset &quot;clone_skb 1&quot;     sets the number of copies of the same packet
pgset &quot;clone_skb 0&quot;     use single SKB for all transmits
pgset &quot;burst 8&quot;         uses xmit_more API to queue 8 copies of the same
                        packet and update HW tx queue tail pointer once.
                        &quot;burst 1&quot; is the default
pgset &quot;pkt_size 9014&quot;   sets packet size to 9014
pgset &quot;frags 5&quot;         packet will consist of 5 fragments
pgset &quot;count 200000&quot;    sets number of packets to send, set to zero
                        for continuous sends until explicitly stopped.

pgset &quot;delay 5000&quot;      adds delay to hard_start_xmit(). nanoseconds

pgset &quot;dst 10.0.0.1&quot;    sets IP destination address
                        (BEWARE! This generator is very aggressive!)

pgset &quot;dst_min 10.0.0.1&quot;            Same as dst
pgset &quot;dst_max 10.0.0.254&quot;          Set the maximum destination IP.
pgset &quot;src_min 10.0.0.1&quot;            Set the minimum (or only) source IP.
pgset &quot;src_max 10.0.0.254&quot;          Set the maximum source IP.
pgset &quot;dst6 fec0::1&quot;     IPV6 destination address
pgset &quot;src6 fec0::2&quot;     IPV6 source address
pgset &quot;dstmac 00:00:00:00:00:00&quot;    sets MAC destination address
pgset &quot;srcmac 00:00:00:00:00:00&quot;    sets MAC source address

pgset &quot;queue_map_min 0&quot; Sets the min value of tx queue interval
pgset &quot;queue_map_max 7&quot; Sets the max value of tx queue interval, for multiqueue devices
                        To select queue 1 of a given device,
                        use queue_map_min=1 and queue_map_max=1

pgset &quot;src_mac_count 1&quot; Sets the number of MACs we&#39;ll range through.
                        The &#39;minimum&#39; MAC is what you set with srcmac.

pgset &quot;dst_mac_count 1&quot; Sets the number of MACs we&#39;ll range through.
                        The &#39;minimum&#39; MAC is what you set with dstmac.

pgset &quot;flag [name]&quot;     Set a flag to determine behaviour.  Current flags
                        are: IPSRC_RND # IP source is random (between min/max)
                             IPDST_RND # IP destination is random
                             UDPSRC_RND, UDPDST_RND,
                             MACSRC_RND, MACDST_RND
                             TXSIZE_RND, IPV6,
                             MPLS_RND, VID_RND, SVID_RND
                             FLOW_SEQ,
                             QUEUE_MAP_RND # queue map random
                             QUEUE_MAP_CPU # queue map mirrors smp_processor_id()
                             UDPCSUM,
                             IPSEC # IPsec encapsulation (needs CONFIG_XFRM)
                             NODE_ALLOC # node specific memory allocation
                             NO_TIMESTAMP # disable timestamping
pgset &#39;flag ![name]&#39;    Clear a flag to determine behaviour.
                        Note that you might need to use single quote in
                        interactive mode, so that your shell wouldn&#39;t expand
                        the specified flag as a history command.

pgset &quot;spi [SPI_VALUE]&quot; Set specific SA used to transform packet.

pgset &quot;udp_src_min 9&quot;   set UDP source port min, If &lt; udp_src_max, then
                        cycle through the port range.

pgset &quot;udp_src_max 9&quot;   set UDP source port max.
pgset &quot;udp_dst_min 9&quot;   set UDP destination port min, If &lt; udp_dst_max, then
                        cycle through the port range.
pgset &quot;udp_dst_max 9&quot;   set UDP destination port max.

pgset &quot;mpls 0001000a,0002000a,0000000a&quot; set MPLS labels (in this example
                                        outer label=16,middle label=32,
                                        inner label=0 (IPv4 NULL)) Note that
                                        there must be no spaces between the
                                        arguments. Leading zeros are required.
                                        Do not set the bottom of stack bit,
                                        that&#39;s done automatically. If you do
                                        set the bottom of stack bit, that
                                        indicates that you want to randomly
                                        generate that address and the flag
                                        MPLS_RND will be turned on. You
                                        can have any mix of random and fixed
                                        labels in the label stack.

pgset &quot;mpls 0&quot;           turn off mpls (or any invalid argument works too!)

pgset &quot;vlan_id 77&quot;       set VLAN ID 0-4095
pgset &quot;vlan_p 3&quot;         set priority bit 0-7 (default 0)
pgset &quot;vlan_cfi 0&quot;       set canonical format identifier 0-1 (default 0)

pgset &quot;svlan_id 22&quot;      set SVLAN ID 0-4095
pgset &quot;svlan_p 3&quot;        set priority bit 0-7 (default 0)
pgset &quot;svlan_cfi 0&quot;      set canonical format identifier 0-1 (default 0)

pgset &quot;vlan_id 9999&quot;     &gt; 4095 remove vlan and svlan tags
pgset &quot;svlan 9999&quot;       &gt; 4095 remove svlan tag


pgset &quot;tos XX&quot;           set former IPv4 TOS field (e.g. &quot;tos 28&quot; for AF11 no ECN, default 00)
pgset &quot;traffic_class XX&quot; set former IPv6 TRAFFIC CLASS (e.g. &quot;traffic_class B8&quot; for EF no ECN, default 00)

pgset &quot;rate 300M&quot;        set rate to 300 Mb/s
pgset &quot;ratep 1000000&quot;    set rate to 1Mpps

pgset &quot;xmit_mode netif_receive&quot;  RX inject into stack netif_receive_skb()
                                 Works with &quot;burst&quot; but not with &quot;clone_skb&quot;.
                                 Default xmit_mode is &quot;start_xmit&quot;.
</pre></div>
</div>
</div>
<div class="section" id="sample-scripts">
<h2>Sample scripts<a class="headerlink" href="#sample-scripts" title="Permalink to this headline">¶</a></h2>
<p>A collection of tutorial scripts and helpers for pktgen is in the
samples/pktgen directory. The helper parameters.sh file support easy
and consistent parameter parsing across the sample scripts.</p>
<p>Usage example and help:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>./pktgen_sample01_simple.sh -i eth4 -m 00:1B:21:3C:9D:F8 -d 192.168.8.2
</pre></div>
</div>
<p>Usage::</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>./pktgen_sample01_simple.sh [-vx] -i ethX

-i : ($DEV)       output interface/device (required)
-s : ($PKT_SIZE)  packet size
-d : ($DEST_IP)   destination IP. CIDR (e.g. 198.18.0.0/15) is also allowed
-m : ($DST_MAC)   destination MAC-addr
-p : ($DST_PORT)  destination PORT range (e.g. 433-444) is also allowed
-t : ($THREADS)   threads to start
-f : ($F_THREAD)  index of first thread (zero indexed CPU number)
-c : ($SKB_CLONE) SKB clones send before alloc new SKB
-n : ($COUNT)     num messages to send per thread, 0 means indefinitely
-b : ($BURST)     HW level bursting of SKBs
-v : ($VERBOSE)   verbose
-x : ($DEBUG)     debug
-6 : ($IP6)       IPv6
-w : ($DELAY)     Tx Delay value (ns)
-a : ($APPEND)    Script will not reset generator&#39;s state, but will append its config
</pre></div>
</div>
<p>The global variables being set are also listed.  E.g. the required
interface/device parameter “-i” sets variable $DEV.  Copy the
pktgen_sampleXX scripts and modify them to fit your own needs.</p>
</div>
<div class="section" id="interrupt-affinity">
<h2>Interrupt affinity<a class="headerlink" href="#interrupt-affinity" title="Permalink to this headline">¶</a></h2>
<p>Note that when adding devices to a specific CPU it is a good idea to
also assign /proc/irq/XX/smp_affinity so that the TX interrupts are bound
to the same CPU.  This reduces cache bouncing when freeing skbs.</p>
<p>Plus using the device flag QUEUE_MAP_CPU, which maps the SKBs TX queue
to the running threads CPU (directly from smp_processor_id()).</p>
</div>
<div class="section" id="enable-ipsec">
<h2>Enable IPsec<a class="headerlink" href="#enable-ipsec" title="Permalink to this headline">¶</a></h2>
<p>Default IPsec transformation with ESP encapsulation plus transport mode
can be enabled by simply setting:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pgset &quot;flag IPSEC&quot;
pgset &quot;flows 1&quot;
</pre></div>
</div>
<p>To avoid breaking existing testbed scripts for using AH type and tunnel mode,
you can use “pgset spi SPI_VALUE” to specify which transformation mode
to employ.</p>
</div>
<div class="section" id="current-commands-and-configuration-options">
<h2>Current commands and configuration options<a class="headerlink" href="#current-commands-and-configuration-options" title="Permalink to this headline">¶</a></h2>
<p><strong>Pgcontrol commands</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>start
stop
reset
</pre></div>
</div>
<p><strong>Thread commands</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>add_device
rem_device_all
</pre></div>
</div>
<p><strong>Device commands</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>count
clone_skb
burst
debug

frags
delay

src_mac_count
dst_mac_count

pkt_size
min_pkt_size
max_pkt_size

queue_map_min
queue_map_max
skb_priority

tos           (ipv4)
traffic_class (ipv6)

mpls

udp_src_min
udp_src_max

udp_dst_min
udp_dst_max

node

flag
IPSRC_RND
IPDST_RND
UDPSRC_RND
UDPDST_RND
MACSRC_RND
MACDST_RND
TXSIZE_RND
IPV6
MPLS_RND
VID_RND
SVID_RND
FLOW_SEQ
QUEUE_MAP_RND
QUEUE_MAP_CPU
UDPCSUM
IPSEC
NODE_ALLOC
NO_TIMESTAMP

spi (ipsec)

dst_min
dst_max

src_min
src_max

dst_mac
src_mac

clear_counters

src6
dst6
dst6_max
dst6_min

flows
flowlen

rate
ratep

xmit_mode &lt;start_xmit|netif_receive&gt;

vlan_cfi
vlan_id
vlan_p

svlan_cfi
svlan_id
svlan_p
</pre></div>
</div>
<p>References:</p>
<ul class="simple">
<li><a class="reference external" href="ftp://robur.slu.se/pub/Linux/net-development/pktgen-testing/">ftp://robur.slu.se/pub/Linux/net-development/pktgen-testing/</a></li>
<li><a class="reference external" href="ftp://robur.slu.se/pub/Linux/net-development/pktgen-testing/examples/">ftp://robur.slu.se/pub/Linux/net-development/pktgen-testing/examples/</a></li>
</ul>
<p>Paper from Linux-Kongress in Erlangen 2004.
- <a class="reference external" href="ftp://robur.slu.se/pub/Linux/net-development/pktgen-testing/pktgen_paper.pdf">ftp://robur.slu.se/pub/Linux/net-development/pktgen-testing/pktgen_paper.pdf</a></p>
<p>Thanks to:</p>
<p>Grant Grundler for testing on IA-64 and parisc, Harald Welte,  Lennert Buytenhek
Stephen Hemminger, Andi Kleen, Dave Miller and many others.</p>
<p>Good luck with the linux net-development.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="plip.html" class="btn btn-neutral float-right" title="PLIP: The Parallel Line Internet Protocol Device" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="phonet.html" class="btn btn-neutral" title="Linux Phonet protocol family" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'5.18.0-rc1-torvalds+',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>