

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>6.1. Introduction &mdash; The Linux Kernel 5.18.0-rc1-torvalds+ documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../_static/theme_overrides.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/theme_rtd_colors.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="The Linux Kernel 5.18.0-rc1-torvalds+ documentation" href="../../../index.html"/>
        <link rel="up" title="6. LIRC Device Interface" href="lirc-dev.html"/>
        <link rel="next" title="6.5. LIRC Function Reference" href="lirc-func.html"/>
        <link rel="prev" title="6. LIRC Device Interface" href="lirc-dev.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.18.0-rc2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../kbuild/index.html">Kernel Build System</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../devicetree/index.html">Open Firmware and Devicetree</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">The Linux kernel user-space API guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../no_new_privs.html">No New Privileges Flag</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../seccomp_filter.html">Seccomp BPF (SECure COMPuting with filters)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../landlock.html">Landlock: unprivileged access control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../unshare.html">unshare system call</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec_ctrl.html">Speculation Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../accelerators/ocxl.html">OpenCAPI (Open Coherent Accelerator Processor Interface)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ebpf/index.html">eBPF Userspace API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ioctl/index.html">IOCTLs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../iommu.html">IOMMU Userspace API</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Linux Media Infrastructure userspace API</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v4l/v4l2.html">Part I - Video for Linux API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dvb/dvbapi.html">Part II - Digital TV API</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="remote_controllers.html">Part III - Remote Controller API</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="rc-intro.html">1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="rc-sysfs-nodes.html">2. Remote Controller’s sysfs nodes</a></li>
<li class="toctree-l4"><a class="reference internal" href="rc-protos.html">3. Remote Controller Protocols and Scancodes</a></li>
<li class="toctree-l4"><a class="reference internal" href="rc-tables.html">4. Remote controller tables</a></li>
<li class="toctree-l4"><a class="reference internal" href="rc-table-change.html">5. Changing default Remote Controller mappings</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="lirc-dev.html">6. LIRC Device Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="remote_controllers.html#revision-and-copyright">Revision and Copyright</a></li>
<li class="toctree-l4"><a class="reference internal" href="remote_controllers.html#revision-history">Revision History</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../mediactl/media-controller.html">Part IV - Media Controller API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cec/cec-api.html">Part V - Consumer Electronics Control API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gen-errors.html">Generic Error Codes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fdl-appendix.html">GNU Free Documentation License</a></li>
<li class="toctree-l3"><a class="reference internal" href="../drivers/index.html">Video4Linux (V4L)  driver-specific documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../sysfs-platform_profile.html">Platform Profile Selection (e.g. /sys/firmware/acpi/platform_profile)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vduse.html">VDUSE - “vDPA Device in Userspace”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../futex2.html">futex2</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../maintainer/index.html">Kernel Maintainer Handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fault-injection/index.html">fault-injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../livepatch/index.html">Kernel Livepatching</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../locking/index.html">locking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../accounting/index.html">Accounting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../block/index.html">Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cdrom/index.html">cdrom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cpu-freq/index.html">Linux CPUFreq - CPU frequency and voltage scaling code in the Linux(TM) kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ide/index.html">Integrated Drive Electronics (IDE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fb/index.html">Frame Buffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fpga/index.html">fpga</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hid/index.html">Human Interface Devices (HID)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../i2c/index.html">I2C/SMBus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../iio/index.html">Industrial I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../isdn/index.html">ISDN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../infiniband/index.html">InfiniBand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../leds/index.html">LEDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../netlabel/index.html">NetLabel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../networking/index.html">Linux Networking Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pcmcia/index.html">pcmcia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../power/index.html">Power Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../target/index.html">TCM Virtual Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../timers/index.html">timers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../spi/index.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../w1/index.html">1-Wire Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../watchdog/index.html">Linux Watchdog Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../virt/index.html">Linux Virtualization Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hwmon/index.html">Linux Hardware Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../filesystems/index.html">Filesystems in the Linux kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../vm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usb/index.html">USB support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../PCI/index.html">Linux PCI Bus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scsi/index.html">Linux SCSI Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scheduler/index.html">Linux Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mhi/index.html">MHI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tty/index.html">TTY</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../peci/index.html">Linux PECI Subsystem</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../asm-annotations.html">Assembler Annotations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../arch.html">CPU Architectures</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tools/index.html">Kernel tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../staging/index.html">Unsorted Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../staging/index.html#atomic-types">Atomic Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../staging/index.html#atomic-bitops">Atomic bitops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../staging/index.html#memory-barriers">Memory Barriers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../watch_queue.html">General notification mechanism</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../translations/index.html">Translations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">The Linux Kernel</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">The Linux kernel user-space API guide</a> &raquo;</li>
        
          <li><a href="../index.html">Linux Media Infrastructure userspace API</a> &raquo;</li>
        
          <li><a href="remote_controllers.html">Part III - Remote Controller API</a> &raquo;</li>
        
          <li><a href="lirc-dev.html">6. LIRC Device Interface</a> &raquo;</li>
        
      <li>6.1. Introduction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/userspace-api/media/rc/lirc-dev-intro.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction">
<span id="lirc-dev-intro"></span><h1>6.1. Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>LIRC stands for Linux Infrared Remote Control. The LIRC device interface is
a bi-directional interface for transporting raw IR and decoded scancodes
data between userspace and kernelspace. Fundamentally, it is just a chardev
(/dev/lircX, for X = 0, 1, 2, …), with a number of standard struct
file_operations defined on it. With respect to transporting raw IR and
decoded scancodes to and fro, the essential fops are read, write and ioctl.</p>
<p>It is also possible to attach a BPF program to a LIRC device for decoding
raw IR into scancodes.</p>
<p>Example dmesg output upon a driver registering w/LIRC:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ dmesg |grep lirc_dev
rc rc0: lirc_dev: driver mceusb registered at minor = 0, raw IR receiver, raw IR transmitter
</pre></div>
</div>
<p>What you should see for a chardev:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ ls -l /dev/lirc*
crw-rw---- 1 root root 248, 0 Jul 2 22:20 /dev/lirc0
</pre></div>
</div>
<p>Note that the package <a class="reference external" href="https://git.linuxtv.org/v4l-utils.git/">v4l-utils</a>
contains tools for working with LIRC devices:</p>
<blockquote>
<div><ul class="simple">
<li>ir-ctl: can receive raw IR and transmit IR, as well as query LIRC
device features.</li>
<li>ir-keytable: can load keymaps; allows you to set IR kernel protocols; load
BPF IR decoders and test IR decoding. Some BPF IR decoders are also
provided.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="lirc-modes">
<span id="id1"></span><h1>6.2. LIRC modes<a class="headerlink" href="#lirc-modes" title="Permalink to this headline">¶</a></h1>
<p>LIRC supports some modes of receiving and sending IR codes, as shown
on the following table.</p>
<p id="lirc-scancode-flag-repeat"><span id="lirc-scancode-flag-toggle"></span><span id="lirc-mode-scancode"></span><code class="docutils literal notranslate"><span class="pre">LIRC_MODE_SCANCODE</span></code></p>
<blockquote>
<div><p>This mode is for both sending and receiving IR.</p>
<p>For transmitting (aka sending), create a struct lirc_scancode with
the desired scancode set in the <code class="docutils literal notranslate"><span class="pre">scancode</span></code> member, <code class="xref c c-type docutils literal notranslate"><span class="pre">rc_proto</span></code>
set to the <a class="reference internal" href="rc-protos.html#remote-controllers-protocols"><span class="std std-ref">IR protocol</span></a>, and all other
members set to 0. Write this struct to the lirc device.</p>
<p>For receiving, you read struct lirc_scancode from the LIRC device.
The <code class="docutils literal notranslate"><span class="pre">scancode</span></code> field is set to the received scancode and the
<a class="reference internal" href="rc-protos.html#remote-controllers-protocols"><span class="std std-ref">IR protocol</span></a> is set in
<code class="xref c c-type docutils literal notranslate"><span class="pre">rc_proto</span></code>. If the scancode maps to a valid key code, this is set
in the <code class="docutils literal notranslate"><span class="pre">keycode</span></code> field, else it is set to <code class="docutils literal notranslate"><span class="pre">KEY_RESERVED</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">flags</span></code> can have <code class="docutils literal notranslate"><span class="pre">LIRC_SCANCODE_FLAG_TOGGLE</span></code> set if the toggle
bit is set in protocols that support it (e.g. rc-5 and rc-6), or
<code class="docutils literal notranslate"><span class="pre">LIRC_SCANCODE_FLAG_REPEAT</span></code> for when a repeat is received for protocols
that support it (e.g. nec).</p>
<p>In the Sanyo and NEC protocol, if you hold a button on remote, rather than
repeating the entire scancode, the remote sends a shorter message with
no scancode, which just means button is held, a “repeat”. When this is
received, the <code class="docutils literal notranslate"><span class="pre">LIRC_SCANCODE_FLAG_REPEAT</span></code> is set and the scancode and
keycode is repeated.</p>
<p>With nec, there is no way to distinguish “button hold” from “repeatedly
pressing the same button”. The rc-5 and rc-6 protocols have a toggle bit.
When a button is released and pressed again, the toggle bit is inverted.
If the toggle bit is set, the <code class="docutils literal notranslate"><span class="pre">LIRC_SCANCODE_FLAG_TOGGLE</span></code> is set.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">timestamp</span></code> field is filled with the time nanoseconds
(in <code class="docutils literal notranslate"><span class="pre">CLOCK_MONOTONIC</span></code>) when the scancode was decoded.</p>
</div></blockquote>
<p id="lirc-mode-mode2"><code class="docutils literal notranslate"><span class="pre">LIRC_MODE_MODE2</span></code></p>
<blockquote>
<div><p>The driver returns a sequence of pulse and space codes to userspace,
as a series of u32 values.</p>
<p>This mode is used only for IR receive.</p>
<p>The upper 8 bits determine the packet type, and the lower 24 bits
the payload. Use <code class="docutils literal notranslate"><span class="pre">LIRC_VALUE()</span></code> macro to get the payload, and
the macro <code class="docutils literal notranslate"><span class="pre">LIRC_MODE2()</span></code> will give you the type, which
is one of:</p>
<p><code class="docutils literal notranslate"><span class="pre">LIRC_MODE2_PULSE</span></code></p>
<blockquote>
<div>Signifies the presence of IR in microseconds, also known as <em>flash</em>.</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">LIRC_MODE2_SPACE</span></code></p>
<blockquote>
<div>Signifies absence of IR in microseconds, also known as <em>gap</em>.</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">LIRC_MODE2_FREQUENCY</span></code></p>
<blockquote>
<div>If measurement of the carrier frequency was enabled with
<a class="reference internal" href="lirc-set-measure-carrier-mode.html#lirc-set-measure-carrier-mode"><span class="std std-ref">ioctl LIRC_SET_MEASURE_CARRIER_MODE</span></a> then this packet gives you
the carrier frequency in Hertz.</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">LIRC_MODE2_TIMEOUT</span></code></p>
<blockquote>
<div>When the timeout set with <a class="reference internal" href="lirc-set-rec-timeout.html#lirc-set-rec-timeout"><span class="std std-ref">ioctl LIRC_GET_REC_TIMEOUT and LIRC_SET_REC_TIMEOUT</span></a> expires due
to no IR being detected, this packet will be sent, with the number
of microseconds with no IR.</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">LIRC_MODE2_OVERFLOW</span></code></p>
<blockquote>
<div>Signifies that the IR receiver encounter an overflow, and some IR
is missing. The IR data after this should be correct again. The
actual value is not important, but this is set to 0xffffff by the
kernel for compatibility with lircd.</div></blockquote>
</div></blockquote>
<p id="lirc-mode-pulse"><code class="docutils literal notranslate"><span class="pre">LIRC_MODE_PULSE</span></code></p>
<blockquote>
<div><p>In pulse mode, a sequence of pulse/space integer values are written to the
lirc device using <a class="reference internal" href="lirc-write.html#lirc-write"><span class="std std-ref">LIRC write()</span></a>.</p>
<p>The values are alternating pulse and space lengths, in microseconds. The
first and last entry must be a pulse, so there must be an odd number
of entries.</p>
<p>This mode is used only for IR send.</p>
</div></blockquote>
</div>
<div class="section" id="data-types-used-by-lirc-mode-scancode">
<h1>6.3. Data types used by LIRC_MODE_SCANCODE<a class="headerlink" href="#data-types-used-by-lirc-mode-scancode" title="Permalink to this headline">¶</a></h1>
<dl class="type">
<dt id="c.MC.lirc_scancode">
struct <code class="descname">lirc_scancode</code><a class="headerlink" href="#c.MC.lirc_scancode" title="Permalink to this definition">¶</a></dt>
<dd><p>decoded scancode with protocol for use with LIRC_MODE_SCANCODE</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct lirc_scancode {
  __u64 timestamp;
  __u16 flags;
  __u16 rc_proto;
  __u32 keycode;
  __u64 scancode;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">timestamp</span></code></dt>
<dd>Timestamp in nanoseconds using CLOCK_MONOTONIC when IR
was decoded.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">flags</span></code></dt>
<dd>should be 0 for transmit. When receiving scancodes,
LIRC_SCANCODE_FLAG_TOGGLE or LIRC_SCANCODE_FLAG_REPEAT can be set
depending on the protocol</dd>
<dt><code class="docutils literal notranslate"><span class="pre">rc_proto</span></code></dt>
<dd>see enum rc_proto</dd>
<dt><code class="docutils literal notranslate"><span class="pre">keycode</span></code></dt>
<dd>the translated keycode. Set to 0 for transmit.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">scancode</span></code></dt>
<dd>the scancode received or to be sent</dd>
</dl>
<dl class="type">
<dt id="c.MC.rc_proto">
enum <code class="descname">rc_proto</code><a class="headerlink" href="#c.MC.rc_proto" title="Permalink to this definition">¶</a></dt>
<dd><p>the Remote Controller protocol</p>
</dd></dl>

<p><strong>Constants</strong></p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_UNKNOWN</span></code></dt>
<dd>Protocol not known</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_OTHER</span></code></dt>
<dd>Protocol known but proprietary</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_RC5</span></code></dt>
<dd>Philips RC5 protocol</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_RC5X_20</span></code></dt>
<dd>Philips RC5x 20 bit protocol</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_RC5_SZ</span></code></dt>
<dd>StreamZap variant of RC5</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_JVC</span></code></dt>
<dd>JVC protocol</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_SONY12</span></code></dt>
<dd>Sony 12 bit protocol</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_SONY15</span></code></dt>
<dd>Sony 15 bit protocol</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_SONY20</span></code></dt>
<dd>Sony 20 bit protocol</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_NEC</span></code></dt>
<dd>NEC protocol</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_NECX</span></code></dt>
<dd>Extended NEC protocol</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_NEC32</span></code></dt>
<dd>NEC 32 bit protocol</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_SANYO</span></code></dt>
<dd>Sanyo protocol</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_MCIR2_KBD</span></code></dt>
<dd>RC6-ish MCE keyboard</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_MCIR2_MSE</span></code></dt>
<dd>RC6-ish MCE mouse</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_RC6_0</span></code></dt>
<dd>Philips RC6-0-16 protocol</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_RC6_6A_20</span></code></dt>
<dd>Philips RC6-6A-20 protocol</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_RC6_6A_24</span></code></dt>
<dd>Philips RC6-6A-24 protocol</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_RC6_6A_32</span></code></dt>
<dd>Philips RC6-6A-32 protocol</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_RC6_MCE</span></code></dt>
<dd>MCE (Philips RC6-6A-32 subtype) protocol</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_SHARP</span></code></dt>
<dd>Sharp protocol</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_XMP</span></code></dt>
<dd>XMP protocol</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_CEC</span></code></dt>
<dd>CEC protocol</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_IMON</span></code></dt>
<dd>iMon Pad protocol</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_RCMM12</span></code></dt>
<dd>RC-MM protocol 12 bits</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_RCMM24</span></code></dt>
<dd>RC-MM protocol 24 bits</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_RCMM32</span></code></dt>
<dd>RC-MM protocol 32 bits</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_XBOX_DVD</span></code></dt>
<dd>Xbox DVD Movie Playback Kit protocol</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RC_PROTO_MAX</span></code></dt>
<dd>Maximum value of enum rc_proto</dd>
</dl>
</div>
<div class="section" id="bpf-based-ir-decoder">
<h1>6.4. BPF based IR decoder<a class="headerlink" href="#bpf-based-ir-decoder" title="Permalink to this headline">¶</a></h1>
<p>The kernel has support for decoding the most common
<a class="reference internal" href="rc-protos.html#remote-controllers-protocols"><span class="std std-ref">IR protocols</span></a>, but there
are many protocols which are not supported. To support these, it is possible
to load an BPF program which does the decoding. This can only be done on
LIRC devices which support reading raw IR.</p>
<p>First, using the <a class="reference external" href="http://man7.org/linux/man-pages/man2/bpf.2.html">bpf(2)</a> syscall with the <code class="docutils literal notranslate"><span class="pre">BPF_LOAD_PROG</span></code> argument,
program must be loaded of type <code class="docutils literal notranslate"><span class="pre">BPF_PROG_TYPE_LIRC_MODE2</span></code>. Once attached
to the LIRC device, this program will be called for each pulse, space or
timeout event on the LIRC device. The context for the BPF program is a
pointer to a unsigned int, which is a <a class="reference internal" href="#lirc-mode-mode2"><span class="std std-ref">LIRC_MODE_MODE2</span></a>
value. When the program has decoded the scancode, it can be submitted using
the BPF functions <code class="docutils literal notranslate"><span class="pre">bpf_rc_keydown()</span></code> or <code class="docutils literal notranslate"><span class="pre">bpf_rc_repeat()</span></code>. Mouse or pointer
movements can be reported using <code class="docutils literal notranslate"><span class="pre">bpf_rc_pointer_rel()</span></code>.</p>
<p>Once you have the file descriptor for the <code class="docutils literal notranslate"><span class="pre">BPF_PROG_TYPE_LIRC_MODE2</span></code> BPF
program, it can be attached to the LIRC device using the <a class="reference external" href="http://man7.org/linux/man-pages/man2/bpf.2.html">bpf(2)</a> syscall.
The target must be the file descriptor for the LIRC device, and the
attach type must be <code class="docutils literal notranslate"><span class="pre">BPF_LIRC_MODE2</span></code>. No more than 64 BPF programs can be
attached to a single LIRC device at a time.</p>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="lirc-func.html" class="btn btn-neutral float-right" title="6.5. LIRC Function Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="lirc-dev.html" class="btn btn-neutral" title="6. LIRC Device Interface" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'5.18.0-rc1-torvalds+',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../_static/language_data.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>