

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>eBPF Syscall &mdash; The Linux Kernel 5.18.0-rc1-torvalds+ documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/theme_rtd_colors.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="The Linux Kernel 5.18.0-rc1-torvalds+ documentation" href="../../index.html"/>
        <link rel="up" title="eBPF Userspace API" href="index.html"/>
        <link rel="next" title="IOCTLs" href="../ioctl/index.html"/>
        <link rel="prev" title="eBPF Userspace API" href="index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.18.0-rc2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kbuild/index.html">Kernel Build System</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devicetree/index.html">Open Firmware and Devicetree</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">The Linux kernel user-space API guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../no_new_privs.html">No New Privileges Flag</a></li>
<li class="toctree-l2"><a class="reference internal" href="../seccomp_filter.html">Seccomp BPF (SECure COMPuting with filters)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../landlock.html">Landlock: unprivileged access control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unshare.html">unshare system call</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_ctrl.html">Speculation Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../accelerators/ocxl.html">OpenCAPI (Open Coherent Accelerator Processor Interface)</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">eBPF Userspace API</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">eBPF Syscall</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bpf-subcommand-reference">bpf() subcommand reference</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ioctl/index.html">IOCTLs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iommu.html">IOMMU Userspace API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../media/index.html">Linux Media Infrastructure userspace API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sysfs-platform_profile.html">Platform Profile Selection (e.g. /sys/firmware/acpi/platform_profile)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vduse.html">VDUSE - “vDPA Device in Userspace”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../futex2.html">futex2</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../maintainer/index.html">Kernel Maintainer Handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fault-injection/index.html">fault-injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../livepatch/index.html">Kernel Livepatching</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../locking/index.html">locking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../accounting/index.html">Accounting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../block/index.html">Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cdrom/index.html">cdrom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpu-freq/index.html">Linux CPUFreq - CPU frequency and voltage scaling code in the Linux(TM) kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ide/index.html">Integrated Drive Electronics (IDE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fb/index.html">Frame Buffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fpga/index.html">fpga</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hid/index.html">Human Interface Devices (HID)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../i2c/index.html">I2C/SMBus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../iio/index.html">Industrial I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../isdn/index.html">ISDN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../infiniband/index.html">InfiniBand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../leds/index.html">LEDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../netlabel/index.html">NetLabel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking/index.html">Linux Networking Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pcmcia/index.html">pcmcia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../power/index.html">Power Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../target/index.html">TCM Virtual Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../timers/index.html">timers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../spi/index.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../w1/index.html">1-Wire Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../watchdog/index.html">Linux Watchdog Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../virt/index.html">Linux Virtualization Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hwmon/index.html">Linux Hardware Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../filesystems/index.html">Filesystems in the Linux kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usb/index.html">USB support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PCI/index.html">Linux PCI Bus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scsi/index.html">Linux SCSI Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scheduler/index.html">Linux Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mhi/index.html">MHI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tty/index.html">TTY</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../peci/index.html">Linux PECI Subsystem</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../asm-annotations.html">Assembler Annotations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../arch.html">CPU Architectures</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tools/index.html">Kernel tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../staging/index.html">Unsorted Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../staging/index.html#atomic-types">Atomic Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../staging/index.html#atomic-bitops">Atomic bitops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../staging/index.html#memory-barriers">Memory Barriers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../watch_queue.html">General notification mechanism</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../translations/index.html">Translations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">The Linux Kernel</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">The Linux kernel user-space API guide</a> &raquo;</li>
        
          <li><a href="index.html">eBPF Userspace API</a> &raquo;</li>
        
      <li>eBPF Syscall</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/userspace-api/ebpf/syscall.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ebpf-syscall">
<h1>eBPF Syscall<a class="headerlink" href="#ebpf-syscall" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Authors:</th><td class="field-body"><ul class="first last simple">
<li>Alexei Starovoitov &lt;<a class="reference external" href="mailto:ast&#37;&#52;&#48;kernel&#46;org">ast<span>&#64;</span>kernel<span>&#46;</span>org</a>&gt;</li>
<li>Joe Stringer &lt;<a class="reference external" href="mailto:joe&#37;&#52;&#48;wand&#46;net&#46;nz">joe<span>&#64;</span>wand<span>&#46;</span>net<span>&#46;</span>nz</a>&gt;</li>
<li>Michael Kerrisk &lt;<a class="reference external" href="mailto:mtk&#46;manpages&#37;&#52;&#48;gmail&#46;com">mtk<span>&#46;</span>manpages<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The primary info for the bpf syscall is available in the <a class="reference external" href="https://www.kernel.org/doc/man-pages/">man-pages</a>
for <a class="reference external" href="https://man7.org/linux/man-pages/man2/bpf.2.html">bpf(2)</a>.</p>
<div class="section" id="bpf-subcommand-reference">
<h2>bpf() subcommand reference<a class="headerlink" href="#bpf-subcommand-reference" title="Permalink to this headline">¶</a></h2>
<p>The operation to be performed by the <strong>bpf</strong>() system call is determined
by the <em>cmd</em> argument. Each operation takes an accompanying argument,
provided via <em>attr</em>, which is a pointer to a union of type <em>bpf_attr</em> (see
below). The size argument is the size of the union pointed to by <em>attr</em>.</p>
<dl class="docutils">
<dt>BPF_MAP_CREATE</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Create a map and return a file descriptor that refers to the
map. The close-on-exec file descriptor flag (see <strong>fcntl</strong>(2))
is automatically enabled for the new file descriptor.</p>
<p class="last">Applying <strong>close</strong>(2) to the file descriptor returned by
<strong>BPF_MAP_CREATE</strong> will delete the map (but see NOTES).</p>
</dd>
<dt>Return</dt>
<dd>A new file descriptor (a nonnegative integer), or -1 if an
error occurred (in which case, <em>errno</em> is set appropriately).</dd>
</dl>
</dd>
<dt>BPF_MAP_LOOKUP_ELEM</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Look up an element with a given <em>key</em> in the map referred to
by the file descriptor <em>map_fd</em>.</p>
<p>The <em>flags</em> argument may be specified as one of the
following:</p>
<dl class="last docutils">
<dt><strong>BPF_F_LOCK</strong></dt>
<dd>Look up the value of a spin-locked map without
returning the lock. This must be specified if the
elements contain a spinlock.</dd>
</dl>
</dd>
<dt>Return</dt>
<dd>Returns zero on success. On error, -1 is returned and <em>errno</em>
is set appropriately.</dd>
</dl>
</dd>
<dt>BPF_MAP_UPDATE_ELEM</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Create or update an element (key/value pair) in a specified map.</p>
<p>The <em>flags</em> argument should be specified as one of the
following:</p>
<dl class="last docutils">
<dt><strong>BPF_ANY</strong></dt>
<dd>Create a new element or update an existing element.</dd>
<dt><strong>BPF_NOEXIST</strong></dt>
<dd>Create a new element only if it did not exist.</dd>
<dt><strong>BPF_EXIST</strong></dt>
<dd>Update an existing element.</dd>
<dt><strong>BPF_F_LOCK</strong></dt>
<dd>Update a spin_lock-ed map element.</dd>
</dl>
</dd>
<dt>Return</dt>
<dd><p class="first">Returns zero on success. On error, -1 is returned and <em>errno</em>
is set appropriately.</p>
<p>May set <em>errno</em> to <strong>EINVAL</strong>, <strong>EPERM</strong>, <strong>ENOMEM</strong>,
<strong>E2BIG</strong>, <strong>EEXIST</strong>, or <strong>ENOENT</strong>.</p>
<dl class="last docutils">
<dt><strong>E2BIG</strong></dt>
<dd>The number of elements in the map reached the
<em>max_entries</em> limit specified at map creation time.</dd>
<dt><strong>EEXIST</strong></dt>
<dd>If <em>flags</em> specifies <strong>BPF_NOEXIST</strong> and the element
with <em>key</em> already exists in the map.</dd>
<dt><strong>ENOENT</strong></dt>
<dd>If <em>flags</em> specifies <strong>BPF_EXIST</strong> and the element with
<em>key</em> does not exist in the map.</dd>
</dl>
</dd>
</dl>
</dd>
<dt>BPF_MAP_DELETE_ELEM</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd>Look up and delete an element by key in a specified map.</dd>
<dt>Return</dt>
<dd>Returns zero on success. On error, -1 is returned and <em>errno</em>
is set appropriately.</dd>
</dl>
</dd>
<dt>BPF_MAP_GET_NEXT_KEY</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd>Look up an element by key in a specified map and return the key
of the next element. Can be used to iterate over all elements
in the map.</dd>
<dt>Return</dt>
<dd><p class="first">Returns zero on success. On error, -1 is returned and <em>errno</em>
is set appropriately.</p>
<p>The following cases can be used to iterate over all elements of
the map:</p>
<ul class="simple">
<li>If <em>key</em> is not found, the operation returns zero and sets
the <em>next_key</em> pointer to the key of the first element.</li>
<li>If <em>key</em> is found, the operation returns zero and sets the
<em>next_key</em> pointer to the key of the next element.</li>
<li>If <em>key</em> is the last element, returns -1 and <em>errno</em> is set
to <strong>ENOENT</strong>.</li>
</ul>
<p class="last">May set <em>errno</em> to <strong>ENOMEM</strong>, <strong>EFAULT</strong>, <strong>EPERM</strong>, or
<strong>EINVAL</strong> on error.</p>
</dd>
</dl>
</dd>
<dt>BPF_PROG_LOAD</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Verify and load an eBPF program, returning a new file
descriptor associated with the program.</p>
<p>Applying <strong>close</strong>(2) to the file descriptor returned by
<strong>BPF_PROG_LOAD</strong> will unload the eBPF program (but see NOTES).</p>
<p class="last">The close-on-exec file descriptor flag (see <strong>fcntl</strong>(2)) is
automatically enabled for the new file descriptor.</p>
</dd>
<dt>Return</dt>
<dd>A new file descriptor (a nonnegative integer), or -1 if an
error occurred (in which case, <em>errno</em> is set appropriately).</dd>
</dl>
</dd>
<dt>BPF_OBJ_PIN</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Pin an eBPF program or map referred by the specified <em>bpf_fd</em>
to the provided <em>pathname</em> on the filesystem.</p>
<p>The <em>pathname</em> argument must not contain a dot (“.”).</p>
<p>On success, <em>pathname</em> retains a reference to the eBPF object,
preventing deallocation of the object when the original
<em>bpf_fd</em> is closed. This allow the eBPF object to live beyond
<strong>close</strong>(<em>bpf_fd</em>), and hence the lifetime of the parent
process.</p>
<p>Applying <strong>unlink</strong>(2) or similar calls to the <em>pathname</em>
unpins the object from the filesystem, removing the reference.
If no other file descriptors or filesystem nodes refer to the
same object, it will be deallocated (see NOTES).</p>
<p class="last">The filesystem type for the parent directory of <em>pathname</em> must
be <strong>BPF_FS_MAGIC</strong>.</p>
</dd>
<dt>Return</dt>
<dd>Returns zero on success. On error, -1 is returned and <em>errno</em>
is set appropriately.</dd>
</dl>
</dd>
<dt>BPF_OBJ_GET</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd>Open a file descriptor for the eBPF object pinned to the
specified <em>pathname</em>.</dd>
<dt>Return</dt>
<dd>A new file descriptor (a nonnegative integer), or -1 if an
error occurred (in which case, <em>errno</em> is set appropriately).</dd>
</dl>
</dd>
<dt>BPF_PROG_ATTACH</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Attach an eBPF program to a <em>target_fd</em> at the specified
<em>attach_type</em> hook.</p>
<p>The <em>attach_type</em> specifies the eBPF attachment point to
attach the program to, and must be one of <em>bpf_attach_type</em>
(see below).</p>
<p>The <em>attach_bpf_fd</em> must be a valid file descriptor for a
loaded eBPF program of a cgroup, flow dissector, LIRC, sockmap
or sock_ops type corresponding to the specified <em>attach_type</em>.</p>
<p>The <em>target_fd</em> must be a valid file descriptor for a kernel
object which depends on the attach type of <em>attach_bpf_fd</em>:</p>
<p><strong>BPF_PROG_TYPE_CGROUP_DEVICE</strong>,
<strong>BPF_PROG_TYPE_CGROUP_SKB</strong>,
<strong>BPF_PROG_TYPE_CGROUP_SOCK</strong>,
<strong>BPF_PROG_TYPE_CGROUP_SOCK_ADDR</strong>,
<strong>BPF_PROG_TYPE_CGROUP_SOCKOPT</strong>,
<strong>BPF_PROG_TYPE_CGROUP_SYSCTL</strong>,
<strong>BPF_PROG_TYPE_SOCK_OPS</strong></p>
<blockquote>
<div>Control Group v2 hierarchy with the eBPF controller
enabled. Requires the kernel to be compiled with
<strong>CONFIG_CGROUP_BPF</strong>.</div></blockquote>
<p><strong>BPF_PROG_TYPE_FLOW_DISSECTOR</strong></p>
<blockquote>
<div>Network namespace (eg /proc/self/ns/net).</div></blockquote>
<p><strong>BPF_PROG_TYPE_LIRC_MODE2</strong></p>
<blockquote>
<div>LIRC device path (eg /dev/lircN). Requires the kernel
to be compiled with <strong>CONFIG_BPF_LIRC_MODE2</strong>.</div></blockquote>
<p><strong>BPF_PROG_TYPE_SK_SKB</strong>,
<strong>BPF_PROG_TYPE_SK_MSG</strong></p>
<blockquote class="last">
<div>eBPF map of socket type (eg <strong>BPF_MAP_TYPE_SOCKHASH</strong>).</div></blockquote>
</dd>
<dt>Return</dt>
<dd>Returns zero on success. On error, -1 is returned and <em>errno</em>
is set appropriately.</dd>
</dl>
</dd>
<dt>BPF_PROG_DETACH</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd>Detach the eBPF program associated with the <em>target_fd</em> at the
hook specified by <em>attach_type</em>. The program must have been
previously attached using <strong>BPF_PROG_ATTACH</strong>.</dd>
<dt>Return</dt>
<dd>Returns zero on success. On error, -1 is returned and <em>errno</em>
is set appropriately.</dd>
</dl>
</dd>
<dt>BPF_PROG_TEST_RUN</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Run the eBPF program associated with the <em>prog_fd</em> a <em>repeat</em>
number of times against a provided program context <em>ctx_in</em> and
data <em>data_in</em>, and return the modified program context
<em>ctx_out</em>, <em>data_out</em> (for example, packet data), result of the
execution <em>retval</em>, and <em>duration</em> of the test run.</p>
<p>The sizes of the buffers provided as input and output
parameters <em>ctx_in</em>, <em>ctx_out</em>, <em>data_in</em>, and <em>data_out</em> must
be provided in the corresponding variables <em>ctx_size_in</em>,
<em>ctx_size_out</em>, <em>data_size_in</em>, and/or <em>data_size_out</em>. If any
of these parameters are not provided (ie set to NULL), the
corresponding size field must be zero.</p>
<p>Some program types have particular requirements:</p>
<dl class="docutils">
<dt><strong>BPF_PROG_TYPE_SK_LOOKUP</strong></dt>
<dd><em>data_in</em> and <em>data_out</em> must be NULL.</dd>
</dl>
<p><strong>BPF_PROG_TYPE_RAW_TRACEPOINT</strong>,
<strong>BPF_PROG_TYPE_RAW_TRACEPOINT_WRITABLE</strong></p>
<blockquote>
<div><em>ctx_out</em>, <em>data_in</em> and <em>data_out</em> must be NULL.
<em>repeat</em> must be zero.</div></blockquote>
<p class="last">BPF_PROG_RUN is an alias for BPF_PROG_TEST_RUN.</p>
</dd>
<dt>Return</dt>
<dd><p class="first">Returns zero on success. On error, -1 is returned and <em>errno</em>
is set appropriately.</p>
<dl class="last docutils">
<dt><strong>ENOSPC</strong></dt>
<dd>Either <em>data_size_out</em> or <em>ctx_size_out</em> is too small.</dd>
<dt><strong>ENOTSUPP</strong></dt>
<dd>This command is not supported by the program type of
the program referred to by <em>prog_fd</em>.</dd>
</dl>
</dd>
</dl>
</dd>
<dt>BPF_PROG_GET_NEXT_ID</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Fetch the next eBPF program currently loaded into the kernel.</p>
<p class="last">Looks for the eBPF program with an id greater than <em>start_id</em>
and updates <em>next_id</em> on success. If no other eBPF programs
remain with ids higher than <em>start_id</em>, returns -1 and sets
<em>errno</em> to <strong>ENOENT</strong>.</p>
</dd>
<dt>Return</dt>
<dd>Returns zero on success. On error, or when no id remains, -1
is returned and <em>errno</em> is set appropriately.</dd>
</dl>
</dd>
<dt>BPF_MAP_GET_NEXT_ID</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Fetch the next eBPF map currently loaded into the kernel.</p>
<p class="last">Looks for the eBPF map with an id greater than <em>start_id</em>
and updates <em>next_id</em> on success. If no other eBPF maps
remain with ids higher than <em>start_id</em>, returns -1 and sets
<em>errno</em> to <strong>ENOENT</strong>.</p>
</dd>
<dt>Return</dt>
<dd>Returns zero on success. On error, or when no id remains, -1
is returned and <em>errno</em> is set appropriately.</dd>
</dl>
</dd>
<dt>BPF_PROG_GET_FD_BY_ID</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd>Open a file descriptor for the eBPF program corresponding to
<em>prog_id</em>.</dd>
<dt>Return</dt>
<dd>A new file descriptor (a nonnegative integer), or -1 if an
error occurred (in which case, <em>errno</em> is set appropriately).</dd>
</dl>
</dd>
<dt>BPF_MAP_GET_FD_BY_ID</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd>Open a file descriptor for the eBPF map corresponding to
<em>map_id</em>.</dd>
<dt>Return</dt>
<dd>A new file descriptor (a nonnegative integer), or -1 if an
error occurred (in which case, <em>errno</em> is set appropriately).</dd>
</dl>
</dd>
<dt>BPF_OBJ_GET_INFO_BY_FD</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Obtain information about the eBPF object corresponding to
<em>bpf_fd</em>.</p>
<p>Populates up to <em>info_len</em> bytes of <em>info</em>, which will be in
one of the following formats depending on the eBPF object type
of <em>bpf_fd</em>:</p>
<ul class="last simple">
<li><strong>struct bpf_prog_info</strong></li>
<li><strong>struct bpf_map_info</strong></li>
<li><strong>struct bpf_btf_info</strong></li>
<li><strong>struct bpf_link_info</strong></li>
</ul>
</dd>
<dt>Return</dt>
<dd>Returns zero on success. On error, -1 is returned and <em>errno</em>
is set appropriately.</dd>
</dl>
</dd>
<dt>BPF_PROG_QUERY</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Obtain information about eBPF programs associated with the
specified <em>attach_type</em> hook.</p>
<p>The <em>target_fd</em> must be a valid file descriptor for a kernel
object which depends on the attach type of <em>attach_bpf_fd</em>:</p>
<p><strong>BPF_PROG_TYPE_CGROUP_DEVICE</strong>,
<strong>BPF_PROG_TYPE_CGROUP_SKB</strong>,
<strong>BPF_PROG_TYPE_CGROUP_SOCK</strong>,
<strong>BPF_PROG_TYPE_CGROUP_SOCK_ADDR</strong>,
<strong>BPF_PROG_TYPE_CGROUP_SOCKOPT</strong>,
<strong>BPF_PROG_TYPE_CGROUP_SYSCTL</strong>,
<strong>BPF_PROG_TYPE_SOCK_OPS</strong></p>
<blockquote>
<div>Control Group v2 hierarchy with the eBPF controller
enabled. Requires the kernel to be compiled with
<strong>CONFIG_CGROUP_BPF</strong>.</div></blockquote>
<p><strong>BPF_PROG_TYPE_FLOW_DISSECTOR</strong></p>
<blockquote>
<div>Network namespace (eg /proc/self/ns/net).</div></blockquote>
<p><strong>BPF_PROG_TYPE_LIRC_MODE2</strong></p>
<blockquote>
<div>LIRC device path (eg /dev/lircN). Requires the kernel
to be compiled with <strong>CONFIG_BPF_LIRC_MODE2</strong>.</div></blockquote>
<p><strong>BPF_PROG_QUERY</strong> always fetches the number of programs
attached and the <em>attach_flags</em> which were used to attach those
programs. Additionally, if <em>prog_ids</em> is nonzero and the number
of attached programs is less than <em>prog_cnt</em>, populates
<em>prog_ids</em> with the eBPF program ids of the programs attached
at <em>target_fd</em>.</p>
<p>The following flags may alter the result:</p>
<dl class="last docutils">
<dt><strong>BPF_F_QUERY_EFFECTIVE</strong></dt>
<dd>Only return information regarding programs which are
currently effective at the specified <em>target_fd</em>.</dd>
</dl>
</dd>
<dt>Return</dt>
<dd>Returns zero on success. On error, -1 is returned and <em>errno</em>
is set appropriately.</dd>
</dl>
</dd>
<dt>BPF_RAW_TRACEPOINT_OPEN</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Attach an eBPF program to a tracepoint <em>name</em> to access kernel
internal arguments of the tracepoint in their raw form.</p>
<p>The <em>prog_fd</em> must be a valid file descriptor associated with
a loaded eBPF program of type <strong>BPF_PROG_TYPE_RAW_TRACEPOINT</strong>.</p>
<p>No ABI guarantees are made about the content of tracepoint
arguments exposed to the corresponding eBPF program.</p>
<p class="last">Applying <strong>close</strong>(2) to the file descriptor returned by
<strong>BPF_RAW_TRACEPOINT_OPEN</strong> will delete the map (but see NOTES).</p>
</dd>
<dt>Return</dt>
<dd>A new file descriptor (a nonnegative integer), or -1 if an
error occurred (in which case, <em>errno</em> is set appropriately).</dd>
</dl>
</dd>
<dt>BPF_BTF_LOAD</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Verify and load BPF Type Format (BTF) metadata into the kernel,
returning a new file descriptor associated with the metadata.
BTF is described in more detail at
<a class="reference external" href="https://www.kernel.org/doc/html/latest/bpf/btf.html">https://www.kernel.org/doc/html/latest/bpf/btf.html</a>.</p>
<p>The <em>btf</em> parameter must point to valid memory providing
<em>btf_size</em> bytes of BTF binary metadata.</p>
<p>The returned file descriptor can be passed to other <strong>bpf</strong>()
subcommands such as <strong>BPF_PROG_LOAD</strong> or <strong>BPF_MAP_CREATE</strong> to
associate the BTF with those objects.</p>
<p class="last">Similar to <strong>BPF_PROG_LOAD</strong>, <strong>BPF_BTF_LOAD</strong> has optional
parameters to specify a <em>btf_log_buf</em>, <em>btf_log_size</em> and
<em>btf_log_level</em> which allow the kernel to return freeform log
output regarding the BTF verification process.</p>
</dd>
<dt>Return</dt>
<dd>A new file descriptor (a nonnegative integer), or -1 if an
error occurred (in which case, <em>errno</em> is set appropriately).</dd>
</dl>
</dd>
<dt>BPF_BTF_GET_FD_BY_ID</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd>Open a file descriptor for the BPF Type Format (BTF)
corresponding to <em>btf_id</em>.</dd>
<dt>Return</dt>
<dd>A new file descriptor (a nonnegative integer), or -1 if an
error occurred (in which case, <em>errno</em> is set appropriately).</dd>
</dl>
</dd>
<dt>BPF_TASK_FD_QUERY</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Obtain information about eBPF programs associated with the
target process identified by <em>pid</em> and <em>fd</em>.</p>
<p>If the <em>pid</em> and <em>fd</em> are associated with a tracepoint, kprobe
or uprobe perf event, then the <em>prog_id</em> and <em>fd_type</em> will
be populated with the eBPF program id and file descriptor type
of type <strong>bpf_task_fd_type</strong>. If associated with a kprobe or
uprobe, the  <em>probe_offset</em> and <em>probe_addr</em> will also be
populated. Optionally, if <em>buf</em> is provided, then up to
<em>buf_len</em> bytes of <em>buf</em> will be populated with the name of
the tracepoint, kprobe or uprobe.</p>
<p class="last">The resulting <em>prog_id</em> may be introspected in deeper detail
using <strong>BPF_PROG_GET_FD_BY_ID</strong> and <strong>BPF_OBJ_GET_INFO_BY_FD</strong>.</p>
</dd>
<dt>Return</dt>
<dd>Returns zero on success. On error, -1 is returned and <em>errno</em>
is set appropriately.</dd>
</dl>
</dd>
<dt>BPF_MAP_LOOKUP_AND_DELETE_ELEM</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Look up an element with the given <em>key</em> in the map referred to
by the file descriptor <em>fd</em>, and if found, delete the element.</p>
<p>For <strong>BPF_MAP_TYPE_QUEUE</strong> and <strong>BPF_MAP_TYPE_STACK</strong> map
types, the <em>flags</em> argument needs to be set to 0, but for other
map types, it may be specified as:</p>
<dl class="docutils">
<dt><strong>BPF_F_LOCK</strong></dt>
<dd>Look up and delete the value of a spin-locked map
without returning the lock. This must be specified if
the elements contain a spinlock.</dd>
</dl>
<p>The <strong>BPF_MAP_TYPE_QUEUE</strong> and <strong>BPF_MAP_TYPE_STACK</strong> map types
implement this command as a “pop” operation, deleting the top
element rather than one corresponding to <em>key</em>.
The <em>key</em> and <em>key_len</em> parameters should be zeroed when
issuing this operation for these map types.</p>
<p class="last">This command is only valid for the following map types:
* <strong>BPF_MAP_TYPE_QUEUE</strong>
* <strong>BPF_MAP_TYPE_STACK</strong>
* <strong>BPF_MAP_TYPE_HASH</strong>
* <strong>BPF_MAP_TYPE_PERCPU_HASH</strong>
* <strong>BPF_MAP_TYPE_LRU_HASH</strong>
* <strong>BPF_MAP_TYPE_LRU_PERCPU_HASH</strong></p>
</dd>
<dt>Return</dt>
<dd>Returns zero on success. On error, -1 is returned and <em>errno</em>
is set appropriately.</dd>
</dl>
</dd>
<dt>BPF_MAP_FREEZE</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Freeze the permissions of the specified map.</p>
<p>Write permissions may be frozen by passing zero <em>flags</em>.
Upon success, no future syscall invocations may alter the
map state of <em>map_fd</em>. Write operations from eBPF programs
are still possible for a frozen map.</p>
<p class="last">Not supported for maps of type <strong>BPF_MAP_TYPE_STRUCT_OPS</strong>.</p>
</dd>
<dt>Return</dt>
<dd>Returns zero on success. On error, -1 is returned and <em>errno</em>
is set appropriately.</dd>
</dl>
</dd>
<dt>BPF_BTF_GET_NEXT_ID</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Fetch the next BPF Type Format (BTF) object currently loaded
into the kernel.</p>
<p class="last">Looks for the BTF object with an id greater than <em>start_id</em>
and updates <em>next_id</em> on success. If no other BTF objects
remain with ids higher than <em>start_id</em>, returns -1 and sets
<em>errno</em> to <strong>ENOENT</strong>.</p>
</dd>
<dt>Return</dt>
<dd>Returns zero on success. On error, or when no id remains, -1
is returned and <em>errno</em> is set appropriately.</dd>
</dl>
</dd>
<dt>BPF_MAP_LOOKUP_BATCH</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Iterate and fetch multiple elements in a map.</p>
<p>Two opaque values are used to manage batch operations,
<em>in_batch</em> and <em>out_batch</em>. Initially, <em>in_batch</em> must be set
to NULL to begin the batched operation. After each subsequent
<strong>BPF_MAP_LOOKUP_BATCH</strong>, the caller should pass the resultant
<em>out_batch</em> as the <em>in_batch</em> for the next operation to
continue iteration from the current point.</p>
<p>The <em>keys</em> and <em>values</em> are output parameters which must point
to memory large enough to hold <em>count</em> items based on the key
and value size of the map <em>map_fd</em>. The <em>keys</em> buffer must be
of <em>key_size</em> * <em>count</em>. The <em>values</em> buffer must be of
<em>value_size</em> * <em>count</em>.</p>
<p>The <em>elem_flags</em> argument may be specified as one of the
following:</p>
<dl class="docutils">
<dt><strong>BPF_F_LOCK</strong></dt>
<dd>Look up the value of a spin-locked map without
returning the lock. This must be specified if the
elements contain a spinlock.</dd>
</dl>
<p>On success, <em>count</em> elements from the map are copied into the
user buffer, with the keys copied into <em>keys</em> and the values
copied into the corresponding indices in <em>values</em>.</p>
<p class="last">If an error is returned and <em>errno</em> is not <strong>EFAULT</strong>, <em>count</em>
is set to the number of successfully processed elements.</p>
</dd>
<dt>Return</dt>
<dd><p class="first">Returns zero on success. On error, -1 is returned and <em>errno</em>
is set appropriately.</p>
<p class="last">May set <em>errno</em> to <strong>ENOSPC</strong> to indicate that <em>keys</em> or
<em>values</em> is too small to dump an entire bucket during
iteration of a hash-based map type.</p>
</dd>
</dl>
</dd>
<dt>BPF_MAP_LOOKUP_AND_DELETE_BATCH</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Iterate and delete all elements in a map.</p>
<p>This operation has the same behavior as
<strong>BPF_MAP_LOOKUP_BATCH</strong> with two exceptions:</p>
<ul class="last simple">
<li>Every element that is successfully returned is also deleted
from the map. This is at least <em>count</em> elements. Note that
<em>count</em> is both an input and an output parameter.</li>
<li>Upon returning with <em>errno</em> set to <strong>EFAULT</strong>, up to
<em>count</em> elements may be deleted without returning the keys
and values of the deleted elements.</li>
</ul>
</dd>
<dt>Return</dt>
<dd>Returns zero on success. On error, -1 is returned and <em>errno</em>
is set appropriately.</dd>
</dl>
</dd>
<dt>BPF_MAP_UPDATE_BATCH</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Update multiple elements in a map by <em>key</em>.</p>
<p>The <em>keys</em> and <em>values</em> are input parameters which must point
to memory large enough to hold <em>count</em> items based on the key
and value size of the map <em>map_fd</em>. The <em>keys</em> buffer must be
of <em>key_size</em> * <em>count</em>. The <em>values</em> buffer must be of
<em>value_size</em> * <em>count</em>.</p>
<p>Each element specified in <em>keys</em> is sequentially updated to the
value in the corresponding index in <em>values</em>. The <em>in_batch</em>
and <em>out_batch</em> parameters are ignored and should be zeroed.</p>
<p>The <em>elem_flags</em> argument should be specified as one of the
following:</p>
<dl class="docutils">
<dt><strong>BPF_ANY</strong></dt>
<dd>Create new elements or update a existing elements.</dd>
<dt><strong>BPF_NOEXIST</strong></dt>
<dd>Create new elements only if they do not exist.</dd>
<dt><strong>BPF_EXIST</strong></dt>
<dd>Update existing elements.</dd>
<dt><strong>BPF_F_LOCK</strong></dt>
<dd>Update spin_lock-ed map elements. This must be
specified if the map value contains a spinlock.</dd>
</dl>
<p>On success, <em>count</em> elements from the map are updated.</p>
<p class="last">If an error is returned and <em>errno</em> is not <strong>EFAULT</strong>, <em>count</em>
is set to the number of successfully processed elements.</p>
</dd>
<dt>Return</dt>
<dd><p class="first">Returns zero on success. On error, -1 is returned and <em>errno</em>
is set appropriately.</p>
<p>May set <em>errno</em> to <strong>EINVAL</strong>, <strong>EPERM</strong>, <strong>ENOMEM</strong>, or
<strong>E2BIG</strong>. <strong>E2BIG</strong> indicates that the number of elements in
the map reached the <em>max_entries</em> limit specified at map
creation time.</p>
<p>May set <em>errno</em> to one of the following error codes under
specific circumstances:</p>
<dl class="last docutils">
<dt><strong>EEXIST</strong></dt>
<dd>If <em>flags</em> specifies <strong>BPF_NOEXIST</strong> and the element
with <em>key</em> already exists in the map.</dd>
<dt><strong>ENOENT</strong></dt>
<dd>If <em>flags</em> specifies <strong>BPF_EXIST</strong> and the element with
<em>key</em> does not exist in the map.</dd>
</dl>
</dd>
</dl>
</dd>
<dt>BPF_MAP_DELETE_BATCH</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Delete multiple elements in a map by <em>key</em>.</p>
<p>The <em>keys</em> parameter is an input parameter which must point
to memory large enough to hold <em>count</em> items based on the key
size of the map <em>map_fd</em>, that is, <em>key_size</em> * <em>count</em>.</p>
<p>Each element specified in <em>keys</em> is sequentially deleted. The
<em>in_batch</em>, <em>out_batch</em>, and <em>values</em> parameters are ignored
and should be zeroed.</p>
<p>The <em>elem_flags</em> argument may be specified as one of the
following:</p>
<dl class="docutils">
<dt><strong>BPF_F_LOCK</strong></dt>
<dd>Look up the value of a spin-locked map without
returning the lock. This must be specified if the
elements contain a spinlock.</dd>
</dl>
<p>On success, <em>count</em> elements from the map are updated.</p>
<p class="last">If an error is returned and <em>errno</em> is not <strong>EFAULT</strong>, <em>count</em>
is set to the number of successfully processed elements. If
<em>errno</em> is <strong>EFAULT</strong>, up to <em>count</em> elements may be been
deleted.</p>
</dd>
<dt>Return</dt>
<dd>Returns zero on success. On error, -1 is returned and <em>errno</em>
is set appropriately.</dd>
</dl>
</dd>
<dt>BPF_LINK_CREATE</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd>Attach an eBPF program to a <em>target_fd</em> at the specified
<em>attach_type</em> hook and return a file descriptor handle for
managing the link.</dd>
<dt>Return</dt>
<dd>A new file descriptor (a nonnegative integer), or -1 if an
error occurred (in which case, <em>errno</em> is set appropriately).</dd>
</dl>
</dd>
<dt>BPF_LINK_UPDATE</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd>Update the eBPF program in the specified <em>link_fd</em> to
<em>new_prog_fd</em>.</dd>
<dt>Return</dt>
<dd>Returns zero on success. On error, -1 is returned and <em>errno</em>
is set appropriately.</dd>
</dl>
</dd>
<dt>BPF_LINK_GET_FD_BY_ID</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd>Open a file descriptor for the eBPF Link corresponding to
<em>link_id</em>.</dd>
<dt>Return</dt>
<dd>A new file descriptor (a nonnegative integer), or -1 if an
error occurred (in which case, <em>errno</em> is set appropriately).</dd>
</dl>
</dd>
<dt>BPF_LINK_GET_NEXT_ID</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Fetch the next eBPF link currently loaded into the kernel.</p>
<p class="last">Looks for the eBPF link with an id greater than <em>start_id</em>
and updates <em>next_id</em> on success. If no other eBPF links
remain with ids higher than <em>start_id</em>, returns -1 and sets
<em>errno</em> to <strong>ENOENT</strong>.</p>
</dd>
<dt>Return</dt>
<dd>Returns zero on success. On error, or when no id remains, -1
is returned and <em>errno</em> is set appropriately.</dd>
</dl>
</dd>
<dt>BPF_ENABLE_STATS</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Enable eBPF runtime statistics gathering.</p>
<p>Runtime statistics gathering for the eBPF runtime is disabled
by default to minimize the corresponding performance overhead.
This command enables statistics globally.</p>
<p class="last">Multiple programs may independently enable statistics.
After gathering the desired statistics, eBPF runtime statistics
may be disabled again by calling <strong>close</strong>(2) for the file
descriptor returned by this function. Statistics will only be
disabled system-wide when all outstanding file descriptors
returned by prior calls for this subcommand are closed.</p>
</dd>
<dt>Return</dt>
<dd>A new file descriptor (a nonnegative integer), or -1 if an
error occurred (in which case, <em>errno</em> is set appropriately).</dd>
</dl>
</dd>
<dt>BPF_ITER_CREATE</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Create an iterator on top of the specified <em>link_fd</em> (as
previously created using <strong>BPF_LINK_CREATE</strong>) and return a
file descriptor that can be used to trigger the iteration.</p>
<p class="last">If the resulting file descriptor is pinned to the filesystem
using  <strong>BPF_OBJ_PIN</strong>, then subsequent <strong>read</strong>(2) syscalls
for that path will trigger the iterator to read kernel state
using the eBPF program attached to <em>link_fd</em>.</p>
</dd>
<dt>Return</dt>
<dd>A new file descriptor (a nonnegative integer), or -1 if an
error occurred (in which case, <em>errno</em> is set appropriately).</dd>
</dl>
</dd>
<dt>BPF_LINK_DETACH</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd>Forcefully detach the specified <em>link_fd</em> from its
corresponding attachment point.</dd>
<dt>Return</dt>
<dd>Returns zero on success. On error, -1 is returned and <em>errno</em>
is set appropriately.</dd>
</dl>
</dd>
<dt>BPF_PROG_BIND_MAP</dt>
<dd><dl class="first last docutils">
<dt>Description</dt>
<dd><p class="first">Bind a map to the lifetime of an eBPF program.</p>
<p class="last">The map identified by <em>map_fd</em> is bound to the program
identified by <em>prog_fd</em> and only released when <em>prog_fd</em> is
released. This may be used in cases where metadata should be
associated with a program which otherwise does not contain any
references to the map (for example, embedded in the eBPF
program instructions).</p>
</dd>
<dt>Return</dt>
<dd>Returns zero on success. On error, -1 is returned and <em>errno</em>
is set appropriately.</dd>
</dl>
</dd>
<dt>NOTES</dt>
<dd><p class="first">eBPF objects (maps and programs) can be shared between processes.</p>
<ul class="simple">
<li>After <strong>fork</strong>(2), the child inherits file descriptors
referring to the same eBPF objects.</li>
<li>File descriptors referring to eBPF objects can be transferred over
<strong>unix</strong>(7) domain sockets.</li>
<li>File descriptors referring to eBPF objects can be duplicated in the
usual way, using <strong>dup</strong>(2) and similar calls.</li>
<li>File descriptors referring to eBPF objects can be pinned to the
filesystem using the <strong>BPF_OBJ_PIN</strong> command of <strong>bpf</strong>(2).</li>
</ul>
<p class="last">An eBPF object is deallocated only after all file descriptors referring
to the object have been closed and no references remain pinned to the
filesystem or attached (for example, bound to a program or device).</p>
</dd>
</dl>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../ioctl/index.html" class="btn btn-neutral float-right" title="IOCTLs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="eBPF Userspace API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'5.18.0-rc1-torvalds+',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/language_data.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>