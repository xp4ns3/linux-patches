

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>简介 &mdash; The Linux Kernel 5.18.0-rc1-torvalds+ documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../_static/theme_overrides.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/theme_rtd_colors.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="The Linux Kernel 5.18.0-rc1-torvalds+ documentation" href="../../../index.html"/>
        <link rel="up" title="如何编写内核文档" href="index.html"/>
        <link rel="next" title="编写kernel-doc注释" href="kernel-doc.html"/>
        <link rel="prev" title="如何编写内核文档" href="index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.18.0-rc2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../kbuild/index.html">Kernel Build System</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../devicetree/index.html">Open Firmware and Devicetree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../maintainer/index.html">Kernel Maintainer Handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fault-injection/index.html">fault-injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../livepatch/index.html">Kernel Livepatching</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../locking/index.html">locking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../accounting/index.html">Accounting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../block/index.html">Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cdrom/index.html">cdrom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cpu-freq/index.html">Linux CPUFreq - CPU frequency and voltage scaling code in the Linux(TM) kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ide/index.html">Integrated Drive Electronics (IDE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fb/index.html">Frame Buffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fpga/index.html">fpga</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hid/index.html">Human Interface Devices (HID)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../i2c/index.html">I2C/SMBus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../iio/index.html">Industrial I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../isdn/index.html">ISDN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../infiniband/index.html">InfiniBand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../leds/index.html">LEDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../netlabel/index.html">NetLabel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../networking/index.html">Linux Networking Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pcmcia/index.html">pcmcia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../power/index.html">Power Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../target/index.html">TCM Virtual Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../timers/index.html">timers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../spi/index.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../w1/index.html">1-Wire Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../watchdog/index.html">Linux Watchdog Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../virt/index.html">Linux Virtualization Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hwmon/index.html">Linux Hardware Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../filesystems/index.html">Filesystems in the Linux kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../vm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usb/index.html">USB support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../PCI/index.html">Linux PCI Bus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scsi/index.html">Linux SCSI Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scheduler/index.html">Linux Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mhi/index.html">MHI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tty/index.html">TTY</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../peci/index.html">Linux PECI Subsystem</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../asm-annotations.html">Assembler Annotations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../arch.html">CPU Architectures</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tools/index.html">Kernel tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../staging/index.html">Unsorted Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../staging/index.html#atomic-types">Atomic Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../staging/index.html#atomic-bitops">Atomic bitops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../staging/index.html#memory-barriers">Memory Barriers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../watch_queue.html">General notification mechanism</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Translations</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">中文翻译</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../index.html#id2">许可证文档</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#id3">用户文档</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#id4">固件相关文档</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#id5">应用程序开发人员文档</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html#id6">内核开发简介</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../process/index.html">与Linux 内核社区一起工作</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev-tools/index.html">内核开发工具</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="index.html">如何编写内核文档</a></li>
<li class="toctree-l4"><a class="reference internal" href="../kernel-hacking/index.html">内核骇客指南</a></li>
<li class="toctree-l4"><a class="reference internal" href="../maintainer/index.html">内核维护者手册</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#api">内核API文档</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#id7">体系结构无关文档</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#id8">特定体系结构文档</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#id9">其他文档</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#id10">目录和表格</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../zh_TW/index.html">繁體中文翻譯</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../it_IT/index.html">Traduzione italiana</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ko_KR/index.html">한국어 번역</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ja_JP/index.html">Japanese translations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#disclaimer">Disclaimer</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">The Linux Kernel</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Translations</a> &raquo;</li>
        
          <li><a href="../index.html">中文翻译</a> &raquo;</li>
        
          <li><a href="index.html">如何编写内核文档</a> &raquo;</li>
        
      <li>简介</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/translations/zh_CN/doc-guide/sphinx.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">此文件的目的是为让中文读者更容易阅读和理解，而不是作为一个分支。 因此，
如果您对此文件有任何意见或更新，请先尝试更新原始英文文件。</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">如果您发现本文档与原始文件有任何不同或者有翻译问题，请联系该文件的译者，
或者请求时奎亮的帮助：&lt;<a class="reference external" href="mailto:alexs&#37;&#52;&#48;kernel&#46;org">alexs<span>&#64;</span>kernel<span>&#46;</span>org</a>&gt;。</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Original:</th><td class="field-body"><a class="reference internal" href="../../../doc-guide/sphinx.html"><span class="doc">Introduction</span></a></td>
</tr>
<tr class="field-even field"><th class="field-name">译者:</th><td class="field-body">吴想成 Wu XiangCheng &lt;<a class="reference external" href="mailto:bobwxc&#37;&#52;&#48;email&#46;cn">bobwxc<span>&#64;</span>email<span>&#46;</span>cn</a>&gt;</td>
</tr>
</tbody>
</table>
<div class="section" id="sphinxdoc-zh">
<span id="id1"></span><h1>简介<a class="headerlink" href="#sphinxdoc-zh" title="Permalink to this headline">¶</a></h1>
<p>Linux内核使用 <a class="reference external" href="http://www.sphinx-doc.org/">Sphinx</a> 来把 <code class="docutils literal notranslate"><span class="pre">Documentation</span></code>
下的 <a class="reference external" href="http://docutils.sourceforge.net/rst.html">reStructuredText</a> 文件转
换成漂亮的文档。使用 <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">htmldocs</span></code> 或 <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">pdfdocs</span></code> 命令即可构建HTML
或PDF格式的文档。生成的文档放在 <code class="docutils literal notranslate"><span class="pre">Documentation/output</span></code> 文件夹中。</p>
<p>reStructuredText文件可能包含包含来自源文件的结构化文档注释或kernel-doc注释。
通常它们用于描述代码的功能、类型和设计。kernel-doc注释有一些特殊的结构和
格式，但除此之外，它们还被作为reStructuredText处理。</p>
<p>最后，有成千上万的纯文本文档文件散布在 <code class="docutils literal notranslate"><span class="pre">Documentation</span></code> 里。随着时间推移，
其中一些可能会转换为reStructuredText，但其中大部分仍保持纯文本。</p>
</div>
<div class="section" id="sphinx-install-zh">
<span id="id2"></span><h1>安装Sphinx<a class="headerlink" href="#sphinx-install-zh" title="Permalink to this headline">¶</a></h1>
<p>Documentation/ 下的ReST文件现在使用sphinx1.7或更高版本构建。</p>
<p>这有一个脚本可以检查Sphinx的依赖项。更多详细信息见
<a class="reference internal" href="#sphinx-pre-install-zh"><span class="std std-ref">检查Sphinx依赖项</span></a> 。</p>
<p>大多数发行版都附带了Sphinx，但是它的工具链比较脆弱，而且在您的机器上升级它
或其他一些Python包导致文档构建中断的情况并不少见。</p>
<p>避免此情况的一种方法是使用与发行版附带的不同的版本。因此，建议使用
<code class="docutils literal notranslate"><span class="pre">virtualenv-3</span></code> 或 <code class="docutils literal notranslate"><span class="pre">virtualenv</span></code> 在虚拟环境中安装Sphinx，具体取决于发行版
如何打包Python3。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ol class="last arabic simple">
<li>html输出建议使用RTD主题。根据Sphinx版本的不同，它应该用
<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">sphinx_rtd_theme</span></code> 单独安装。</li>
<li>一些ReST页面包含数学表达式。由于Sphinx的工作方式，这些表达式是使用 LaTeX
编写的。它需要安装amsfonts和amsmath宏包，以便显示。</li>
</ol>
</div>
<p>总之，如您要安装Sphinx 2.4.4版本，应执行:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ virtualenv sphinx_2.4.4
$ . sphinx_2.4.4/bin/activate
(sphinx_2.4.4) $ pip install -r Documentation/sphinx/requirements.txt
</pre></div>
</div>
<p>在运行 <code class="docutils literal notranslate"><span class="pre">.</span> <span class="pre">sphinx_2.4.4/bin/activate</span></code> 之后，提示符将变化，以指示您正在使用新
环境。如果您打开了一个新的shell，那么在构建文档之前，您需要重新运行此命令以再
次进入虚拟环境中。</p>
<div class="section" id="id3">
<h2>图片输出<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>内核文档构建系统包含一个扩展，可以处理GraphViz和SVG格式的图像（参见
<a class="reference internal" href="#sphinx-kfigure-zh"><span class="std std-ref">图形图片</span></a> ）。</p>
<p>为了让它工作，您需要同时安装GraphViz和ImageMagick包。如果没有安装这些软件包，
构建系统仍将构建文档，但不会在输出中包含任何图像。</p>
</div>
<div class="section" id="pdflatex">
<h2>PDF和LaTeX构建<a class="headerlink" href="#pdflatex" title="Permalink to this headline">¶</a></h2>
<p>目前只有Sphinx 2.4及更高版本才支持这种构建。</p>
<p>对于PDF和LaTeX输出，还需要 <code class="docutils literal notranslate"><span class="pre">XeLaTeX</span></code> 3.14159265版本。（译注：此版本号真实
存在）</p>
<p>根据发行版的不同，您可能还需要安装一系列 <code class="docutils literal notranslate"><span class="pre">texlive</span></code> 软件包，这些软件包提供了
<code class="docutils literal notranslate"><span class="pre">XeLaTeX</span></code> 工作所需的最小功能集。</p>
</div>
<div class="section" id="sphinx-pre-install-zh">
<span id="id4"></span><h2>检查Sphinx依赖项<a class="headerlink" href="#sphinx-pre-install-zh" title="Permalink to this headline">¶</a></h2>
<p>这有一个脚本可以自动检查Sphinx依赖项。如果它认得您的发行版，还会提示您所用发行
版的安装命令:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ ./scripts/sphinx-pre-install
Checking if the needed tools for Fedora release 26 (Twenty Six) are available
Warning: better to also install &quot;texlive-luatex85&quot;.
You should run:

        sudo dnf install -y texlive-luatex85
        /usr/bin/virtualenv sphinx_2.4.4
        . sphinx_2.4.4/bin/activate
        pip install -r Documentation/sphinx/requirements.txt

Can&#39;t build as 1 mandatory dependency is missing at ./scripts/sphinx-pre-install line 468.
</pre></div>
</div>
<p>默认情况下，它会检查html和PDF的所有依赖项，包括图像、数学表达式和LaTeX构建的
需求，并假设将使用虚拟Python环境。html构建所需的依赖项被认为是必需的，其他依
赖项则是可选的。</p>
<p>它支持两个可选参数：</p>
<p><code class="docutils literal notranslate"><span class="pre">--no-pdf</span></code></p>
<blockquote>
<div>禁用PDF检查；</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">--no-virtualenv</span></code></p>
<blockquote>
<div>使用Sphinx的系统打包，而不是Python虚拟环境。</div></blockquote>
</div>
</div>
<div class="section" id="id5">
<h1>Sphinx构建<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h1>
<p>生成文档的常用方法是运行 <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">htmldocs</span></code> 或 <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">pdfdocs</span></code> 。还有其它可用
的格式：请参阅 <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">help</span></code> 的文档部分。生成的文档放在 <code class="docutils literal notranslate"><span class="pre">Documentation/output</span></code>
下相应格式的子目录中。</p>
<p>要生成文档，显然必须安装Sphinx（ <code class="docutils literal notranslate"><span class="pre">sphinx-build</span></code> ）。要让HTML输出更漂亮，可以
使用Read the Docs Sphinx主题（ <code class="docutils literal notranslate"><span class="pre">sphinx_rtd_theme</span></code> ）。对于PDF输出，您还需要
<code class="docutils literal notranslate"><span class="pre">XeLaTeX</span></code> 和来自ImageMagick（<a class="reference external" href="https://www.imagemagick.org">https://www.imagemagick.org</a>）的 <code class="docutils literal notranslate"><span class="pre">convert(1)</span></code> 。
所有这些软件在大多发行版中都可用或已打包。</p>
<p>要传递额外的选项给Sphinx，可以使用make变量 <code class="docutils literal notranslate"><span class="pre">SPHINXOPTS</span></code> 。例如，使用
<code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">SPHINXOPTS=-v</span> <span class="pre">htmldocs</span></code> 获得更详细的输出。</p>
<p>要删除生成的文档，请运行 <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">cleandocs</span></code> 。</p>
</div>
<div class="section" id="id6">
<h1>编写文档<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h1>
<p>添加新文档很容易，只需：</p>
<ol class="arabic simple">
<li>在 <code class="docutils literal notranslate"><span class="pre">Documentation</span></code> 下某处添加一个新的 <code class="docutils literal notranslate"><span class="pre">.rst</span></code> 文件。</li>
<li>从 <code class="docutils literal notranslate"><span class="pre">Documentation/index.rst</span></code> 中的Sphinx <a class="reference external" href="http://www.sphinx-doc.org/en/stable/markup/toctree.html">主目录树</a> 链接到它。</li>
</ol>
<p>对于简单的文档（比如您现在正在阅读的文档），这通常已经足够好了，但是对于较大
的文档，最好创建一个子目录（或者使用现有的子目录）。例如，图形子系统文档位于
<code class="docutils literal notranslate"><span class="pre">Documentation/gpu</span></code> 下，拆分为多个 <code class="docutils literal notranslate"><span class="pre">.rst</span></code> 文件，并具有从主目录链接来的单
独索引 <code class="docutils literal notranslate"><span class="pre">index.rst</span></code> （有自己的目录树 <code class="docutils literal notranslate"><span class="pre">toctree</span></code> ）。</p>
<p>请参阅 <a class="reference external" href="http://www.sphinx-doc.org/">Sphinx</a> 和 <a class="reference external" href="http://docutils.sourceforge.net/rst.html">reStructuredText</a> 的文档，以了解如何使用它们。
特别是Sphinx <a class="reference external" href="http://www.sphinx-doc.org/en/stable/rest.html">reStructuredText 基础</a> 这是开始学习使用reStructuredText的
好地方。还有一些 <a class="reference external" href="http://www.sphinx-doc.org/en/stable/markup/index.html">Sphinx 特殊标记结构</a> 。</p>
<div class="section" id="id12">
<h2>内核文档的具体指南<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h2>
<p>这是一些内核文档的具体指南：</p>
<ul>
<li><p class="first">请不要过于痴迷转换格式到reStructuredText。保持简单。在大多数情况下，文档
应该是纯文本，格式应足够一致，以便可以转换为其他格式。</p>
</li>
<li><p class="first">将现有文档转换为reStructuredText时，请尽量减少格式更改。</p>
</li>
<li><p class="first">在转换文档时，还要更新内容，而不仅仅是格式。</p>
</li>
<li><p class="first">请遵循标题修饰符的顺序：</p>
<ol class="arabic">
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">=</span></code> 文档标题，要有上线:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>========
文档标题
========
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">=</span></code> 章:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>章标题
======
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">-</span></code> 节:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>节标题
------
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">~</span></code> 小节:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>小节标题
~~~~~~~~
</pre></div>
</div>
</li>
</ol>
<p>尽管RST没有规定具体的顺序（“没有强加一个固定数量和顺序的节标题装饰风格，最终
按照的顺序将是实际遇到的顺序。”），但是拥有一个通用级别的文档更容易遵循。</p>
</li>
<li><p class="first">对于插入固定宽度的文本块（用于代码样例、用例等）： <code class="docutils literal notranslate"><span class="pre">::</span></code> 用于语法高亮意义不
大的内容，尤其是短代码段； <code class="docutils literal notranslate"><span class="pre">..</span> <span class="pre">code-block::</span> <span class="pre">&lt;language&gt;</span></code> 用于需要语法高亮的
较长代码块。对于嵌入到文本中的简短代码片段，请使用 `` 。</p>
</li>
</ul>
</div>
<div class="section" id="c">
<h2>C域<a class="headerlink" href="#c" title="Permalink to this headline">¶</a></h2>
<p><strong>Sphinx C域（Domain）</strong> （name c）适用于C API文档。例如，函数原型：</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="ow">c:function</span><span class="p">::</span> int ioctl( int fd, int request )
</pre></div>
</div>
<p>内核文档的C域有一些附加特性。例如，您可以使用诸如 <code class="docutils literal notranslate"><span class="pre">open</span></code> 或 <code class="docutils literal notranslate"><span class="pre">ioctl</span></code> 这样的
通用名称重命名函数的引用名称：</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="ow">c:function</span><span class="p">::</span> int ioctl( int fd, int request )
   <span class="nc">:name:</span> VIDIOC_LOG_STATUS
</pre></div>
</div>
<p>函数名称（例如ioctl）仍保留在输出中，但引用名称从 <code class="docutils literal notranslate"><span class="pre">ioctl</span></code> 变为
<code class="docutils literal notranslate"><span class="pre">VIDIOC_LOG_STATUS</span></code> 。此函数的索引项也变为 <code class="docutils literal notranslate"><span class="pre">VIDIOC_LOG_STATUS</span></code> 。</p>
<p>请注意，不需要使用 <code class="docutils literal notranslate"><span class="pre">c:func:</span></code> 生成函数文档的交叉引用。由于一些Sphinx扩展的
神奇力量，如果给定函数名的索引项存在，文档构建系统会自动将对 <code class="docutils literal notranslate"><span class="pre">function()</span></code>
的引用转换为交叉引用。如果在内核文档中看到 <code class="docutils literal notranslate"><span class="pre">c:func:</span></code> 的用法，请删除它。</p>
</div>
<div class="section" id="id13">
<h2>列表<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h2>
<p>我们建议使用 <em>列式表</em> 格式。 <em>列式表</em> 格式是二级列表。与ASCII艺术相比，它们对
文本文件的读者来说可能没有那么舒适。但其优点是易于创建或修改，而且修改的差异
（diff）更有意义，因为差异仅限于修改的内容。</p>
<p><em>平铺表</em> 也是一个二级列表，类似于 <em>列式表</em> ，但具有一些额外特性：</p>
<ul class="simple">
<li>列范围：使用 <code class="docutils literal notranslate"><span class="pre">cspan</span></code> 修饰，可以通过其他列扩展单元格</li>
<li>行范围：使用 <code class="docutils literal notranslate"><span class="pre">rspan</span></code> 修饰，可以通过其他行扩展单元格</li>
<li>自动将表格行最右边的单元格扩展到该行右侧空缺的单元格上。若使用
<code class="docutils literal notranslate"><span class="pre">:fill-cells:</span></code> 选项，此行为可以从 <em>自动合并</em> 更改为 <em>自动插入</em> ，自动
插入（空）单元格，而不是扩展合并到最后一个单元格。</li>
</ul>
<p>选项：</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">:header-rows:</span></code>   [int] 标题行计数</li>
<li><code class="docutils literal notranslate"><span class="pre">:stub-columns:</span></code>  [int] 标题列计数</li>
<li><code class="docutils literal notranslate"><span class="pre">:widths:</span></code>        [[int] [int] … ] 列宽</li>
<li><code class="docutils literal notranslate"><span class="pre">:fill-cells:</span></code>    插入缺少的单元格，而不是自动合并缺少的单元格</li>
</ul>
<p>修饰：</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">:cspan:</span></code> [int] 扩展列</li>
<li><code class="docutils literal notranslate"><span class="pre">:rspan:</span></code> [int] 扩展行</li>
</ul>
<p>下面的例子演示了如何使用这些标记。分级列表的第一级是 <em>表格行</em> 。 <em>表格行</em> 中
只允许一个标记，即该 <em>表格行</em> 中的单元格列表。 <em>comments</em> （ <code class="docutils literal notranslate"><span class="pre">..</span></code> ）和
<em>targets</em> 例外（例如引用 <code class="docutils literal notranslate"><span class="pre">:ref:`最后一行</span> <span class="pre">&lt;last</span> <span class="pre">row_zh&gt;`</span></code> / <a class="reference internal" href="#last-row-zh"><span class="std std-ref">最后一行</span></a> ）。</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="ow">flat-table</span><span class="p">::</span> 表格标题
   <span class="nc">:widths:</span> 2 1 1 3

   <span class="m">*</span> - 表头 列1
     <span class="m">-</span> 表头 列2
     <span class="m">-</span> 表头 列3
     <span class="m">-</span> 表头 列4

   <span class="m">*</span> - 行1
     <span class="m">-</span> 字段1.1
     <span class="m">-</span> 字段1.2（自动扩展）

   <span class="m">*</span> - 行2
     <span class="m">-</span> 字段2.1
     <span class="m">-</span> <span class="na">:rspan:</span><span class="nv">`1`</span> <span class="na">:cspan:</span><span class="nv">`1`</span> 字段2.2~3.3

   <span class="m">*</span> .. _<span class="nv">`last row_zh`</span>:

     <span class="m">-</span> 行3
</pre></div>
</div>
<p>渲染效果：</p>
<blockquote>
<div><table border="1" class="docutils" id="id16">
<caption><span class="caption-text">表格标题</span><a class="headerlink" href="#id16" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="29%" />
<col width="14%" />
<col width="14%" />
<col width="43%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>表头 列1</td>
<td>表头 列2</td>
<td>表头 列3</td>
<td>表头 列4</td>
</tr>
<tr class="row-even"><td>行1</td>
<td>字段1.1</td>
<td colspan="2">字段1.2（自动扩展）</td>
</tr>
<tr class="row-odd"><td>行2</td>
<td>字段2.1</td>
<td colspan="2" rowspan="2">  字段2.2~3.3</td>
</tr>
<tr class="row-even"><td><p class="first last" id="last-row-zh">行3</p>
</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="id14">
<h2>交叉引用<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h2>
<p>从一页文档到另一页文档的交叉引用可以通过简单地写出文件路径来完成，无特殊格式
要求。路径可以是绝对路径或相对路径。绝对路径从“Documentation/”开始。例如，要
交叉引用此页，以下写法皆可，取决于具体的文档目录（注意 <code class="docutils literal notranslate"><span class="pre">.rst</span></code> 扩展名是可选
的）:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>参见 Documentation/doc-guide/sphinx.rst 。此法始终可用。
请查看 sphinx.rst ，仅在同级目录中有效。
请阅读 ../sphinx.rst ，上级目录中的文件。
</pre></div>
</div>
<p>如果要使用相对路径，则需要使用Sphinx的 <code class="docutils literal notranslate"><span class="pre">doc</span></code> 修饰。例如，从同一目录引用此页
的操作如下:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>参见 :doc:`sphinx文档的自定义链接文本 &lt;sphinx&gt;`.
</pre></div>
</div>
<p>对于大多数用例，前者是首选，因为它更干净，更适合阅读源文件的人。如果您遇到一
个没有任何特殊作用的 <code class="docutils literal notranslate"><span class="pre">:doc:</span></code> 用法，请将其转换为文档路径。</p>
<p>有关交叉引用kernel-doc函数或类型的信息，请参阅
<a class="reference internal" href="../../../doc-guide/kernel-doc.html"><span class="doc">Writing kernel-doc comments</span></a> 。</p>
</div>
</div>
<div class="section" id="sphinx-kfigure-zh">
<span id="id15"></span><h1>图形图片<a class="headerlink" href="#sphinx-kfigure-zh" title="Permalink to this headline">¶</a></h1>
<p>如果要添加图片，应该使用 <code class="docutils literal notranslate"><span class="pre">kernel-figure</span></code> 和 <code class="docutils literal notranslate"><span class="pre">kernel-image</span></code> 指令。例如，
要插入具有可缩放图像格式的图形，请使用SVG（<a class="reference internal" href="#svg-image-example-zh"><span class="std std-ref">SVG 图片示例</span></a> ）:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>.. kernel-figure::  ../../../doc-guide/svg_image.svg
   :alt:    简易 SVG 图片

   SVG 图片示例
</pre></div>
</div>
<div class="figure" id="id17">
<img alt="简易 SVG 图片" src="../../../_images/svg_image.svg" /><p class="caption"><span class="caption-text">SVG 图片示例</span></p>
</div>
<p>内核figure（和image）指令支持 DOT 格式文件，请参阅</p>
<ul class="simple">
<li>DOT：<a class="reference external" href="http://graphviz.org/pdf/dotguide.pdf">http://graphviz.org/pdf/dotguide.pdf</a></li>
<li>Graphviz：<a class="reference external" href="http://www.graphviz.org/content/dot-language">http://www.graphviz.org/content/dot-language</a></li>
</ul>
<p>一个简单的例子（<a class="reference internal" href="#hello-dot-file-zh"><span class="std std-ref">DOT 示例</span></a> ）:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>.. kernel-figure::  ../../../doc-guide/hello.dot
   :alt:    你好，世界

   DOT 示例
</pre></div>
</div>
<div class="figure" id="id18">
<img alt="你好，世界" src="../../../_images/hello.svg" /><p class="caption"><span class="caption-text">DOT 示例</span></p>
</div>
<p>嵌入的渲染标记（或语言），如Graphviz的 <strong>DOT</strong> 由 <code class="docutils literal notranslate"><span class="pre">kernel-render</span></code> 指令提供:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>.. kernel-render:: DOT
   :alt: 有向图
   :caption: 嵌入式 **DOT** (Graphviz) 代码

   digraph foo {
    &quot;五棵松&quot; -&gt; &quot;国贸&quot;;
   }
</pre></div>
</div>
<p>如何渲染取决于安装的工具。如果安装了Graphviz，您将看到一个矢量图像。否则，原始
标记将作为 <em>文字块</em> 插入（<a class="reference internal" href="#hello-dot-render-zh"><span class="std std-ref">嵌入式 DOT (Graphviz) 代码</span></a> ）。</p>
<div class="figure" id="id19">
<span id="hello-dot-render-zh"></span><img alt="有向图" src="../../../_images/DOT-77e7d61e58e1605ed4c5b4fb8f641356938e39b1.svg" /><p class="caption"><span class="caption-text">嵌入式 <strong>DOT</strong> (Graphviz) 代码</span></p>
</div>
<p><em>render</em> 指令包含 <em>figure</em> 指令中已知的所有选项，以及选项 <code class="docutils literal notranslate"><span class="pre">caption</span></code> 。如果
<code class="docutils literal notranslate"><span class="pre">caption</span></code> 有值，则插入一个 <em>figure</em> 节点，若无，则插入一个 <em>image</em> 节点。
如果您想引用它，还需要一个 <code class="docutils literal notranslate"><span class="pre">caption</span></code> （<a class="reference internal" href="#hello-svg-render-zh"><span class="std std-ref">嵌入式 SVG 标记</span></a> ）。</p>
<p>嵌入式 <strong>SVG</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>.. kernel-render:: SVG
   :caption: 嵌入式 **SVG** 标记
   :alt: 右上箭头

   &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
   &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; version=&quot;1.1&quot; ...&gt;
      ...
   &lt;/svg&gt;
</pre></div>
</div>
<div class="figure" id="id20">
<span id="hello-svg-render-zh"></span><img alt="右上箭头" src="../../../_images/SVG-3bcc8521eb73e7bcc8b0de14afcc31d733ec6b25.svg" /><p class="caption"><span class="caption-text">嵌入式 <strong>SVG</strong> 标记</span></p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="kernel-doc.html" class="btn btn-neutral float-right" title="编写kernel-doc注释" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="如何编写内核文档" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'5.18.0-rc1-torvalds+',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../_static/language_data.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>